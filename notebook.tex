
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatability definitions
    \def\gt{>}
    \def\lt{<}
    % Document parameters
    \title{Phase\_diff}
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{}statsmodels https://qiita.com/yubais/items/24f49df99b487fdc374d}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}1}]:} \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
        \PY{k+kn}{import} \PY{n+nn}{pandas\PYZus{}profiling} \PY{k}{as} \PY{n+nn}{pdp}
        \PY{k+kn}{import} \PY{n+nn}{seaborn} \PY{k}{as} \PY{n+nn}{sns}
        \PY{k+kn}{import} \PY{n+nn}{statsmodels}\PY{n+nn}{.}\PY{n+nn}{api} \PY{k}{as} \PY{n+nn}{sm}
        \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
        \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
        \PY{k+kn}{from}  \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{import} \PY{n}{scatter}
        \PY{k+kn}{import} \PY{n+nn}{statsmodels}\PY{n+nn}{.}\PY{n+nn}{formula}\PY{n+nn}{.}\PY{n+nn}{api} \PY{k}{as} \PY{n+nn}{smf}
        \PY{k+kn}{import} \PY{n+nn}{statsmodels}\PY{n+nn}{.}\PY{n+nn}{stats}\PY{n+nn}{.}\PY{n+nn}{api} \PY{k}{as} \PY{n+nn}{sms}
        \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
        \PY{k+kn}{from} \PY{n+nn}{statsmodels}\PY{n+nn}{.}\PY{n+nn}{compat} \PY{k}{import} \PY{n}{lzip}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k}{import} \PY{n}{KFold}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{mean\PYZus{}squared\PYZus{}error}
        \PY{k+kn}{import} \PY{n+nn}{math}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{mean\PYZus{}absolute\PYZus{}error}
        \PY{k+kn}{import} \PY{n+nn}{pyper} \PY{k}{as} \PY{n+nn}{pr}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k}{import} \PY{n}{StratifiedKFold}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k}{import} \PY{n}{GroupKFold}
        \PY{k+kn}{from} \PY{n+nn}{statsmodels}\PY{n+nn}{.}\PY{n+nn}{sandbox}\PY{n+nn}{.}\PY{n+nn}{regression}\PY{n+nn}{.}\PY{n+nn}{predstd} \PY{k}{import} \PY{n}{wls\PYZus{}prediction\PYZus{}std}
        \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
        
        
        \PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
C:\textbackslash{}ProgramData\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}statsmodels\textbackslash{}compat\textbackslash{}pandas.py:56: FutureWarning: The pandas.core.datetools module is deprecated and will be removed in a future version. Please use the pandas.tseries module instead.
  from pandas.core import datetools

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}2}]:} \PY{n}{data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{rawdata.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{encoding} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{shift\PYZus{}jis}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{n}{data}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
        \PY{n}{display}\PY{p}{(}\PY{n}{data}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(700, 3)

    \end{Verbatim}

    
    \begin{verbatim}
  subject  phase_diff  magnitude
0     永井君           0        5.5
1     永井君          20        4.5
2     永井君          40        4.0
3     永井君          60        5.0
4     永井君          80        4.5
    \end{verbatim}

    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}3}]:} \PY{n}{pdp}\PY{o}{.}\PY{n}{ProfileReport}\PY{p}{(}\PY{n}{data}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}3}]:} <pandas\_profiling.ProfileReport at 0x5644978>
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}4}]:} \PY{n}{valid\PYZus{}subject} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{上島君}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{志村君}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{仙石君}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{渡邉君}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{梅津君}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{横山君}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{向畑君}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{浅田君}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{池田君}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{岩崎君}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
        \PY{n}{data} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{data}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{subject}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{isin}\PY{p}{(}\PY{n}{valid\PYZus{}subject}\PY{p}{)}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{drop} \PY{o}{=} \PY{k+kc}{True}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{n}{data}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
        \PY{n}{data}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(600, 3)

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}4}]:}     subject  phase\_diff  magnitude
        0       横山君           0        6.0
        1       横山君          20        5.0
        2       横山君          40        3.5
        3       横山君          60        1.0
        4       横山君          80        2.0
        5       横山君         100        3.0
        6       横山君         120        5.0
        7       横山君         140        2.5
        8       横山君         160        3.0
        9       横山君         180        2.0
        10      横山君           0        5.5
        11      横山君          20        5.0
        12      横山君          40        4.5
        13      横山君          60        4.0
        14      横山君          80        3.0
        15      横山君         100        2.0
        16      横山君         120        2.0
        17      横山君         140        2.5
        18      横山君         160        4.0
        19      横山君         180        1.0
        20      横山君           0        6.0
        21      横山君          20        6.0
        22      横山君          40        4.5
        23      横山君          60        2.5
        24      横山君          80        2.0
        25      横山君         100        1.0
        26      横山君         120        3.5
        27      横山君         140        5.0
        28      横山君         160        4.0
        29      横山君         180        4.0
        ..      {\ldots}         {\ldots}        {\ldots}
        570     梅津君           0        7.0
        571     梅津君          20        6.0
        572     梅津君          40        5.0
        573     梅津君          60        6.0
        574     梅津君          80        6.0
        575     梅津君         100        5.0
        576     梅津君         120        5.0
        577     梅津君         140        5.0
        578     梅津君         160        4.0
        579     梅津君         180        4.0
        580     梅津君           0        6.0
        581     梅津君          20        5.0
        582     梅津君          40        5.0
        583     梅津君          60        5.0
        584     梅津君          80        5.0
        585     梅津君         100        5.0
        586     梅津君         120        5.0
        587     梅津君         140        5.0
        588     梅津君         160        4.0
        589     梅津君         180        4.0
        590     梅津君           0        6.0
        591     梅津君          20        4.0
        592     梅津君          40        5.0
        593     梅津君          60        6.0
        594     梅津君          80        4.0
        595     梅津君         100        4.0
        596     梅津君         120        4.0
        597     梅津君         140        4.0
        598     梅津君         160        4.0
        599     梅津君         180        4.0
        
        [600 rows x 3 columns]
\end{Verbatim}
            
    \section{散布図}\label{ux6563ux5e03ux56f3}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}5}]:} \PY{n}{g} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{lmplot}\PY{p}{(}\PY{n}{x} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{phase\PYZus{}diff}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{y} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{magnitude}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{data} \PY{o}{=} \PY{n}{data}\PY{p}{,} \PY{n}{fit\PYZus{}reg} \PY{o}{=} \PY{k+kc}{False}\PY{p}{,} \PY{n}{x\PYZus{}jitter} \PY{o}{=} \PY{l+m+mi}{3} \PY{p}{,} \PY{n}{y\PYZus{}jitter} \PY{o}{=} \PY{l+m+mf}{0.1}\PY{p}{)}
        \PY{n}{g}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}5}]:} <seaborn.axisgrid.FacetGrid at 0xc118f98>
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_6_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}6}]:} \PY{n}{g} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{swarmplot}\PY{p}{(}\PY{n}{x} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{phase\PYZus{}diff}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{y} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{magnitude}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{data} \PY{o}{=} \PY{n}{data}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_7_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}7}]:} \PY{k}{for} \PY{n}{phase\PYZus{}diff} \PY{o+ow}{in} \PY{n}{data}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{phase\PYZus{}diff}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}\PY{p}{:}
            \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{phase\PYZus{}diff =}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{phase\PYZus{}diff}\PY{p}{)}
            \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}
            \PY{n}{sns}\PY{o}{.}\PY{n}{distplot}\PY{p}{(}\PY{n}{data}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{data}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{phase\PYZus{}diff}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{==} \PY{n}{phase\PYZus{}diff}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{magnitude}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{kde}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
            \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{phase\PYZus{}diff = }\PY{l+s+s2}{\PYZdq{}}\PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{phase\PYZus{}diff}\PY{p}{)}\PY{p}{)}
            \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
phase\_diff = 0

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
C:\textbackslash{}ProgramData\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}matplotlib\textbackslash{}axes\textbackslash{}\_axes.py:6462: UserWarning: The 'normed' kwarg is deprecated, and has been replaced by the 'density' kwarg.
  warnings.warn("The 'normed' kwarg is deprecated, and has been "

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_8_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
phase\_diff = 20

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_8_4.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
phase\_diff = 40

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_8_6.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
phase\_diff = 60

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_8_8.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
phase\_diff = 80

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_8_10.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
phase\_diff = 100

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_8_12.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
phase\_diff = 120

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_8_14.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
phase\_diff = 140

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_8_16.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
phase\_diff = 160

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_8_18.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
phase\_diff = 180

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_8_20.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}8}]:} \PY{c+c1}{\PYZsh{}kde?}
        \PY{n}{sns}\PY{o}{.}\PY{n}{violinplot}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{phase\PYZus{}diff}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{magnitude}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{data} \PY{o}{=} \PY{n}{data}\PY{p}{,} \PY{n}{split}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}
                       \PY{n}{inner}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{quart}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}8}]:} <matplotlib.axes.\_subplots.AxesSubplot at 0xd262630>
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_9_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}9}]:} \PY{n}{sns}\PY{o}{.}\PY{n}{swarmplot}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{phase\PYZus{}diff}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{y} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{magnitude}\PY{l+s+s2}{\PYZdq{}} \PY{p}{,} \PY{n}{data} \PY{o}{=}\PY{n}{data}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}9}]:} <matplotlib.axes.\_subplots.AxesSubplot at 0xd192080>
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_10_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}10}]:} \PY{k}{for} \PY{n}{phase} \PY{o+ow}{in} \PY{n}{data}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{phase\PYZus{}diff}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}\PY{p}{:}
             \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}
             \PY{n}{sns}\PY{o}{.}\PY{n}{distplot}\PY{p}{(} \PY{n}{data}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{data}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{phase\PYZus{}diff}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{==} \PY{n}{phase}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{magnitude}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
C:\textbackslash{}ProgramData\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}matplotlib\textbackslash{}axes\textbackslash{}\_axes.py:6462: UserWarning: The 'normed' kwarg is deprecated, and has been replaced by the 'density' kwarg.
  warnings.warn("The 'normed' kwarg is deprecated, and has been "

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_11_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_11_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_11_3.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_11_4.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_11_5.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_11_6.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_11_7.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_11_8.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_11_9.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_11_10.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}11}]:} \PY{n}{subject\PYZus{}list} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{subject}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
         \PY{n}{subject\PYZus{}list}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}11}]:} array(['横山君', '岩崎君', '向畑君', '志村君', '上島君', '仙石君', '浅田君', '池田君', '渡邉君',
                '梅津君'], dtype=object)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}12}]:} \PY{n}{subject\PYZus{}list} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{subject}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
         
         \PY{k}{for} \PY{n}{subject} \PY{o+ow}{in} \PY{n}{subject\PYZus{}list}\PY{p}{:}
             \PY{n}{sns}\PY{o}{.}\PY{n}{violinplot}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{phase\PYZus{}diff}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{magnitude}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{hue} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{subject}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{data} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{data}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{subject}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{==}\PY{n}{subject}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}
                        \PY{n}{inner}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{quart}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_13_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_13_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_13_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_13_3.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_13_4.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_13_5.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_13_6.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_13_7.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_13_8.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_13_9.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}13}]:} \PY{c+c1}{\PYZsh{}phase\PYZus{}diffに沿った平均}
         \PY{n}{phase\PYZus{}diff\PYZus{}mean} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{phase\PYZus{}diff}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}
         \PY{n}{phase\PYZus{}diff\PYZus{}mean}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{phase\PYZus{}diff}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{phase\PYZus{}diff\PYZus{}mean}\PY{o}{.}\PY{n}{index}
         \PY{n}{display}\PY{p}{(}\PY{n}{phase\PYZus{}diff\PYZus{}mean}\PY{p}{)}
         \PY{n}{sns}\PY{o}{.}\PY{n}{lmplot}\PY{p}{(}\PY{n}{x} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{phase\PYZus{}diff}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{y} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{magnitude}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{data} \PY{o}{=} \PY{n}{phase\PYZus{}diff\PYZus{}mean}\PY{p}{,} \PY{n}{fit\PYZus{}reg} \PY{o}{=} \PY{k+kc}{None}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}data.groupby([\PYZdq{}subject\PYZdq{}, \PYZdq{}phase\PYZus{}diff\PYZdq{}]).var()}
\end{Verbatim}


    
    \begin{verbatim}
            magnitude  phase_diff
phase_diff                       
0            4.663333           0
20           4.175000          20
40           3.813333          40
60           3.508333          60
80           3.293333          80
100          3.158333         100
120          3.376667         120
140          3.441667         140
160          3.396667         160
180          3.235000         180
    \end{verbatim}

    
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}13}]:} <seaborn.axisgrid.FacetGrid at 0xcb2fba8>
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_14_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}14}]:} \PY{c+c1}{\PYZsh{}phase\PYZus{}diffに沿った分散}
         \PY{n}{phase\PYZus{}diff\PYZus{}var} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{phase\PYZus{}diff}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{var}\PY{p}{(}\PY{p}{)}
         \PY{n}{phase\PYZus{}diff\PYZus{}var}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{phase\PYZus{}diff}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{phase\PYZus{}diff\PYZus{}var}\PY{o}{.}\PY{n}{index}
         \PY{n}{display}\PY{p}{(}\PY{n}{phase\PYZus{}diff\PYZus{}var}\PY{p}{)}
         \PY{n}{sns}\PY{o}{.}\PY{n}{lmplot}\PY{p}{(}\PY{n}{x} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{phase\PYZus{}diff}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{y} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{magnitude}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{data} \PY{o}{=} \PY{n}{phase\PYZus{}diff\PYZus{}var}\PY{p}{,} \PY{n}{fit\PYZus{}reg} \PY{o}{=} \PY{k+kc}{None}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{var\PYZus{}of\PYZus{}magnitude}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}data.groupby([\PYZdq{}subject\PYZdq{}, \PYZdq{}phase\PYZus{}diff\PYZdq{}]).var()}
\end{Verbatim}


    
    \begin{verbatim}
            magnitude  phase_diff
phase_diff                       
0            1.832192           0
20           1.855805          20
40           2.012701          40
60           2.453319          60
80           2.807073          80
100          2.682133         100
120          2.318090         120
140          2.865184         140
160          3.486429         160
180          2.859602         180
    \end{verbatim}

    
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}14}]:} Text(1.69444,0.5,'var\_of\_magnitude')
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_15_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \section{被験者ごとの分散の変化}\label{ux88abux9a13ux8005ux3054ux3068ux306eux5206ux6563ux306eux5909ux5316}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}15}]:} \PY{n}{sub\PYZus{}phase\PYZus{}diff\PYZus{}var} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{subject}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{phase\PYZus{}diff}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{var}\PY{p}{(}\PY{p}{)}
         \PY{n}{sub\PYZus{}phase\PYZus{}diff\PYZus{}var}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{phase\PYZus{}diff}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{sub\PYZus{}phase\PYZus{}diff\PYZus{}var}\PY{o}{.}\PY{n}{index}\PY{o}{.}\PY{n}{get\PYZus{}level\PYZus{}values}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{sub\PYZus{}phase\PYZus{}diff\PYZus{}var}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{subject}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{sub\PYZus{}phase\PYZus{}diff\PYZus{}var}\PY{o}{.}\PY{n}{index}\PY{o}{.}\PY{n}{get\PYZus{}level\PYZus{}values}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}
         \PY{n}{display}\PY{p}{(}\PY{n}{sub\PYZus{}phase\PYZus{}diff\PYZus{}var}\PY{p}{)}
         \PY{n}{sns}\PY{o}{.}\PY{n}{lmplot}\PY{p}{(}\PY{n}{x} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{phase\PYZus{}diff}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{y} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{magnitude}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{data} \PY{o}{=} \PY{n}{sub\PYZus{}phase\PYZus{}diff\PYZus{}var}\PY{p}{,} \PY{n}{hue} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{subject}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{fit\PYZus{}reg} \PY{o}{=} \PY{k+kc}{None}\PY{p}{)}
\end{Verbatim}


    
    \begin{verbatim}
                    magnitude  phase_diff subject
subject phase_diff                               
上島君     0            0.500000           0     上島君
        20           0.275000          20     上島君
        40           0.566667          40     上島君
        60           0.700000          60     上島君
        80           0.241667          80     上島君
        100          0.141667         100     上島君
        120          0.341667         120     上島君
        140          0.566667         140     上島君
        160          0.766667         160     上島君
        180          0.700000         180     上島君
仙石君     0            0.975000           0     仙石君
        20           2.800000          20     仙石君
        40           2.000000          40     仙石君
        60           4.166667          60     仙石君
        80           5.041667          80     仙石君
        100          1.766667         100     仙石君
        120          1.241667         120     仙石君
        140          2.775000         140     仙石君
        160          3.275000         160     仙石君
        180          4.566667         180     仙石君
向畑君     0            0.300000           0     向畑君
        20           0.666667          20     向畑君
        40           1.066667          40     向畑君
        60           0.866667          60     向畑君
        80           0.241667          80     向畑君
        100          0.400000         100     向畑君
        120          0.400000         120     向畑君
        140          0.400000         140     向畑君
        160          0.566667         160     向畑君
        180          0.700000         180     向畑君
...                       ...         ...     ...
池田君     0            0.046667           0     池田君
        20           0.481667          20     池田君
        40           1.061667          40     池田君
        60           0.641667          60     池田君
        80           0.575000          80     池田君
        100          1.141667         100     池田君
        120          0.355000         120     池田君
        140          0.575000         140     池田君
        160          0.966667         160     池田君
        180          0.324000         180     池田君
浅田君     0            0.166667           0     浅田君
        20           0.141667          20     浅田君
        40           0.229667          40     浅田君
        60           0.775000          60     浅田君
        80           1.690667          80     浅田君
        100          1.441667         100     浅田君
        120          0.780000         120     浅田君
        140          1.166667         140     浅田君
        160          2.366667         160     浅田君
        180          0.966667         180     浅田君
渡邉君     0            0.666667           0     渡邉君
        20           1.066667          20     渡邉君
        40           3.375000          40     渡邉君
        60           1.366667          60     渡邉君
        80           0.800000          80     渡邉君
        100          1.466667         100     渡邉君
        120          0.841667         120     渡邉君
        140          2.400000         140     渡邉君
        160          1.466667         160     渡邉君
        180          2.041667         180     渡邉君

[100 rows x 3 columns]
    \end{verbatim}

    
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}15}]:} <seaborn.axisgrid.FacetGrid at 0xc309f98>
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_17_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \section{線形回帰}\label{ux7ddaux5f62ux56deux5e30}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}16}]:} \PY{n}{results} \PY{o}{=} \PY{n}{smf}\PY{o}{.}\PY{n}{ols}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{magnitude \PYZti{} phase\PYZus{}diff}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{data} \PY{o}{=} \PY{n}{data}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{p}{)}
         \PY{n}{display}\PY{p}{(}\PY{n}{results}\PY{o}{.}\PY{n}{summary}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    
    \begin{verbatim}
<class 'statsmodels.iolib.summary.Summary'>
"""
                            OLS Regression Results                            
==============================================================================
Dep. Variable:              magnitude   R-squared:                       0.048
Model:                            OLS   Adj. R-squared:                  0.047
Method:                 Least Squares   F-statistic:                     30.41
Date:                Wed, 23 May 2018   Prob (F-statistic):           5.20e-08
Time:                        11:27:18   Log-Likelihood:                -1132.3
No. Observations:                 600   AIC:                             2269.
Df Residuals:                     598   BIC:                             2277.
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P>|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept      4.1705      0.121     34.355      0.000       3.932       4.409
phase_diff    -0.0063      0.001     -5.515      0.000      -0.009      -0.004
==============================================================================
Omnibus:                       48.026   Durbin-Watson:                   0.695
Prob(Omnibus):                  0.000   Jarque-Bera (JB):               20.709
Skew:                           0.237   Prob(JB):                     3.18e-05
Kurtosis:                       2.223   Cond. No.                         198.
==============================================================================

Warnings:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
"""
    \end{verbatim}

    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}17}]:} \PY{c+c1}{\PYZsh{}seabornはstatsmodelを使っている}
         \PY{n}{sns}\PY{o}{.}\PY{n}{lmplot}\PY{p}{(}\PY{n}{x} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{phase\PYZus{}diff}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{y} \PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{magnitude}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{data} \PY{o}{=} \PY{n}{data}\PY{p}{,} \PY{n}{fit\PYZus{}reg}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}17}]:} <seaborn.axisgrid.FacetGrid at 0xce8e978>
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_20_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}18}]:} \PY{n}{prstd}\PY{p}{,} \PY{n}{iv\PYZus{}l}\PY{p}{,} \PY{n}{iv\PYZus{}u} \PY{o}{=} \PY{n}{wls\PYZus{}prediction\PYZus{}std}\PY{p}{(}\PY{n}{results}\PY{p}{)}
         
         \PY{n}{x1} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{phase\PYZus{}diff}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
         \PY{n}{y}\PY{o}{=}\PY{n}{data}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{magnitude}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{x1}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{o}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Data}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{x1}\PY{p}{,} \PY{n}{results}\PY{o}{.}\PY{n}{fittedvalues}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{x1}\PY{p}{,} \PY{n}{iv\PYZus{}u}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Ordinary Least Squares}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{x1}\PY{p}{,} \PY{n}{iv\PYZus{}l}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{loc}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{best}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{;}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_21_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}19}]:} \PY{n}{g} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{lmplot}\PY{p}{(}\PY{n}{x} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{phase\PYZus{}diff}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{y} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{magnitude}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{data} \PY{o}{=} \PY{n}{data}\PY{p}{,} \PY{n}{fit\PYZus{}reg} \PY{o}{=} \PY{k+kc}{False}\PY{p}{,} \PY{n}{x\PYZus{}jitter} \PY{o}{=} \PY{l+m+mi}{4} \PY{p}{,} \PY{n}{y\PYZus{}jitter} \PY{o}{=} \PY{l+m+mf}{0.1}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{x1}\PY{p}{,} \PY{n}{results}\PY{o}{.}\PY{n}{fittedvalues}\PY{o}{\PYZhy{}}\PY{l+m+mf}{1.3342483164983157}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{x1}\PY{p}{,} \PY{n}{results}\PY{o}{.}\PY{n}{fittedvalues}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{x1}\PY{p}{,} \PY{n}{results}\PY{o}{.}\PY{n}{fittedvalues}\PY{o}{+}\PY{l+m+mf}{1.3342483164983157}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{display}\PY{p}{(}\PY{n}{g}\PY{p}{)}
\end{Verbatim}


    
    \begin{verbatim}
<seaborn.axisgrid.FacetGrid at 0xfca8b38>
    \end{verbatim}

    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_22_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \section{等分散の検定}\label{ux7b49ux5206ux6563ux306eux691cux5b9a}

    OLSは等分散の仮定がなされた元で最良の推定量である．しかし，等分散には見えない．

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}20}]:} \PY{c+c1}{\PYZsh{}Breucsh\PYZhy{}Pagan test　を行う　https://en.wikipedia.org/wiki/Breusch\PYZpc{}E2\PYZpc{}80\PYZpc{}93Pagan\PYZus{}test}
         \PY{c+c1}{\PYZsh{}http://www.statsmodels.org/dev/examples/notebooks/generated/regression\PYZus{}diagnostics.html}
         \PY{c+c1}{\PYZsh{}http://www3.u\PYZhy{}toyama.ac.jp/kkarato/2013/econometrics/handout/Econometrics\PYZhy{}2013\PYZhy{}28\PYZhy{}0127.pdf}
         \PY{c+c1}{\PYZsh{}帰無仮説　「等分散である」}
         \PY{n}{name} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Lagrange multiplier statistic}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{p\PYZhy{}value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} 
                 \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{f\PYZhy{}value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{f p\PYZhy{}value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{test} \PY{o}{=} \PY{n}{sms}\PY{o}{.}\PY{n}{het\PYZus{}breuschpagan}\PY{p}{(}\PY{n}{results}\PY{o}{.}\PY{n}{resid}\PY{p}{,} \PY{n}{results}\PY{o}{.}\PY{n}{model}\PY{o}{.}\PY{n}{exog}\PY{p}{)}
         \PY{n}{lzip}\PY{p}{(}\PY{n}{name}\PY{p}{,} \PY{n}{test}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}20}]:} [('Lagrange multiplier statistic', 11.266459704638754),
          ('p-value', 0.0007892009726501096),
          ('f-value', 11.443789834012039),
          ('f p-value', 0.0007642073883316493)]
\end{Verbatim}
            
    p値 \textless{}
0.05より不等分散であると考える(OLS以外のモデルを試す根拠は出来た）

    \section{CV値の計算}\label{cvux5024ux306eux8a08ux7b97}

    これからOLS以外のモデリングを試していくが，結果の比較をすることが必要である．AICなどの情報量基準でも良いが，理解のしやすさからCV値で比較をする．

    splitの仕方が3つあるように思える\\
1.無作為\\
2.各ユーザーごとでsplit(trainのデータに各ユーザのデータが同じ数だけ入る)
内挿\\
3.ユーザでsplit(trainにデータのあるユーザはtestのなかにはない）
被験者に対して外挿\\
4.phase\_diffの値でsplit(trainにあるphase\_diffはtestにない)
位相差に対して外挿

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}21}]:} \PY{c+c1}{\PYZsh{}方法1}
         \PY{n}{kf\PYZus{}random} \PY{o}{=} \PY{n}{KFold}\PY{p}{(}\PY{n}{n\PYZus{}splits} \PY{o}{=} \PY{l+m+mi}{5}\PY{p}{,}\PY{n}{shuffle} \PY{o}{=} \PY{k+kc}{True}\PY{p}{)}
         \PY{n}{kf\PYZus{}random}\PY{o}{.}\PY{n}{get\PYZus{}n\PYZus{}splits}\PY{p}{(}\PY{n}{data}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{kf\PYZus{}random}\PY{p}{)}
         \PY{k}{for} \PY{n}{train\PYZus{}index}\PY{p}{,} \PY{n}{test\PYZus{}index} \PY{o+ow}{in} \PY{n}{kf\PYZus{}random}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{n}{data}\PY{p}{)}\PY{p}{:}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{TRAIN:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{train\PYZus{}index}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{TEST:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{test\PYZus{}index}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{train len}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{train\PYZus{}index}\PY{p}{)}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{test len}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{test\PYZus{}index}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
KFold(n\_splits=5, random\_state=None, shuffle=True)
TRAIN: [  0   1   2   3   4   5   6   7   8   9  10  15  16  17  18  19  20  21
  22  23  24  25  28  29  30  31  32  33  34  35  36  37  38  40  41  42
  43  44  46  47  49  51  52  53  54  57  59  60  61  62  63  65  66  67
  68  69  70  72  73  74  75  76  78  79  81  82  83  84  85  86  87  89
  90  91  92  93  94  95  96  97  99 100 101 102 104 105 106 107 108 109
 110 111 112 115 116 117 118 119 120 121 122 123 126 127 128 129 130 131
 132 133 135 136 139 140 141 142 143 144 146 147 148 149 151 152 154 156
 157 158 159 160 161 162 163 164 166 167 168 170 171 172 173 174 176 177
 178 179 180 181 182 183 184 185 186 187 190 193 195 196 197 198 200 201
 203 205 208 209 210 211 212 213 214 215 218 219 220 221 222 223 225 226
 227 228 230 231 232 234 235 236 238 239 240 243 244 245 246 247 248 249
 251 252 253 254 255 257 258 259 260 261 262 263 264 265 266 270 271 272
 273 274 275 276 277 278 279 280 282 283 284 285 286 287 288 289 290 291
 292 293 294 295 296 297 298 299 300 301 303 304 305 306 307 308 310 312
 313 314 315 317 318 321 322 324 325 326 327 329 332 333 334 335 336 337
 338 339 340 341 344 346 347 348 350 352 353 354 355 356 357 358 359 360
 361 362 363 364 365 366 369 370 371 373 374 375 376 379 380 381 382 383
 384 385 386 387 389 390 391 392 394 395 396 397 398 399 402 403 404 405
 407 408 409 410 411 412 417 418 419 420 421 423 425 426 427 428 429 430
 432 433 434 435 437 439 440 441 442 443 444 445 446 447 448 449 450 451
 452 453 454 455 456 457 458 461 462 463 465 466 467 469 470 471 472 473
 475 476 477 478 479 480 481 482 483 484 485 486 487 488 489 492 493 494
 495 496 497 498 499 500 501 502 504 505 507 509 510 512 513 514 515 516
 517 519 520 522 523 524 525 526 527 528 529 530 531 533 534 536 537 538
 539 540 541 542 544 545 546 547 548 549 550 551 555 556 557 558 559 560
 562 563 564 565 566 567 568 571 572 573 574 575 576 578 580 581 582 583
 585 586 587 588 589 590 592 593 594 595 597 598] TEST: [ 11  12  13  14  26  27  39  45  48  50  55  56  58  64  71  77  80  88
  98 103 113 114 124 125 134 137 138 145 150 153 155 165 169 175 188 189
 191 192 194 199 202 204 206 207 216 217 224 229 233 237 241 242 250 256
 267 268 269 281 302 309 311 316 319 320 323 328 330 331 342 343 345 349
 351 367 368 372 377 378 388 393 400 401 406 413 414 415 416 422 424 431
 436 438 459 460 464 468 474 490 491 503 506 508 511 518 521 532 535 543
 552 553 554 561 569 570 577 579 584 591 596 599]
train len 480 test len 120
TRAIN: [  0   1   2   3   4   5   7   8   9  11  12  13  14  15  16  17  19  22
  23  24  25  26  27  29  30  31  32  33  34  35  36  38  39  40  42  43
  45  47  48  49  50  51  52  54  55  56  57  58  59  60  61  62  64  65
  67  68  69  71  74  76  77  78  80  81  82  83  85  88  89  93  95  96
  98  99 100 101 102 103 104 105 107 109 110 112 113 114 115 116 117 118
 119 121 122 123 124 125 126 128 130 131 132 133 134 136 137 138 139 140
 143 144 145 146 147 148 149 150 151 152 153 155 156 158 159 160 162 163
 165 168 169 170 172 174 175 177 178 179 180 182 183 184 185 186 187 188
 189 190 191 192 194 195 198 199 200 201 202 204 205 206 207 208 209 210
 211 212 213 215 216 217 218 219 220 221 222 223 224 225 226 227 229 231
 232 233 234 235 237 238 239 240 241 242 243 244 247 248 249 250 251 253
 254 255 256 258 259 260 261 263 264 265 266 267 268 269 270 272 274 277
 278 279 280 281 282 283 284 285 288 289 291 292 293 294 295 296 298 300
 301 302 303 309 310 311 312 313 314 315 316 317 319 320 321 322 323 325
 326 327 328 329 330 331 332 333 334 335 336 337 338 339 340 341 342 343
 345 348 349 350 351 352 353 354 355 356 357 358 359 364 365 366 367 368
 369 370 372 373 375 376 377 378 379 381 382 383 384 385 386 388 389 390
 391 392 393 394 396 397 398 399 400 401 402 403 404 405 406 408 409 410
 411 412 413 414 415 416 417 418 419 421 422 423 424 425 426 427 428 430
 431 432 433 435 436 437 438 439 440 441 442 443 444 446 447 448 449 450
 451 452 453 455 456 458 459 460 461 462 463 464 465 466 467 468 469 470
 471 473 474 475 476 477 480 481 482 483 485 486 487 489 490 491 492 493
 494 496 497 498 500 501 502 503 504 505 506 507 508 511 512 513 514 515
 517 518 519 520 521 522 523 524 525 526 527 528 531 532 533 534 535 536
 538 539 541 542 543 544 545 548 549 551 552 553 554 555 556 558 559 560
 561 562 564 566 567 568 569 570 571 572 573 575 576 577 578 579 580 581
 582 584 586 588 590 591 592 593 594 595 596 599] TEST: [  6  10  18  20  21  28  37  41  44  46  53  63  66  70  72  73  75  79
  84  86  87  90  91  92  94  97 106 108 111 120 127 129 135 141 142 154
 157 161 164 166 167 171 173 176 181 193 196 197 203 214 228 230 236 245
 246 252 257 262 271 273 275 276 286 287 290 297 299 304 305 306 307 308
 318 324 344 346 347 360 361 362 363 371 374 380 387 395 407 420 429 434
 445 454 457 472 478 479 484 488 495 499 509 510 516 529 530 537 540 546
 547 550 557 563 565 574 583 585 587 589 597 598]
train len 480 test len 120
TRAIN: [  1   2   6   7   8   9  10  11  12  13  14  15  16  17  18  20  21  22
  23  26  27  28  29  30  31  33  34  35  37  39  40  41  43  44  45  46
  48  49  50  51  52  53  54  55  56  57  58  59  60  61  62  63  64  66
  67  68  70  71  72  73  75  76  77  78  79  80  82  83  84  85  86  87
  88  89  90  91  92  93  94  95  96  97  98  99 100 101 103 104 105 106
 107 108 110 111 112 113 114 115 117 118 119 120 122 123 124 125 126 127
 128 129 130 131 132 133 134 135 136 137 138 141 142 143 144 145 146 147
 148 150 152 153 154 155 156 157 158 160 161 162 164 165 166 167 169 170
 171 173 174 175 176 177 178 181 182 183 185 187 188 189 190 191 192 193
 194 195 196 197 199 200 201 202 203 204 205 206 207 208 211 212 213 214
 215 216 217 218 219 220 221 222 224 225 226 228 229 230 231 233 234 236
 237 238 239 241 242 243 244 245 246 247 248 249 250 252 253 254 255 256
 257 260 262 263 264 265 266 267 268 269 270 271 273 274 275 276 277 278
 279 280 281 282 284 285 286 287 288 290 291 292 293 295 296 297 298 299
 300 301 302 303 304 305 306 307 308 309 310 311 314 315 316 317 318 319
 320 321 322 323 324 326 327 328 329 330 331 333 334 337 338 342 343 344
 345 346 347 348 349 350 351 353 355 356 357 360 361 362 363 364 365 367
 368 371 372 373 374 377 378 380 381 382 383 384 385 386 387 388 390 391
 393 394 395 396 397 398 399 400 401 402 404 406 407 408 410 411 413 414
 415 416 418 419 420 421 422 423 424 426 429 430 431 432 433 434 435 436
 438 440 442 443 444 445 447 449 451 452 453 454 455 456 457 459 460 464
 465 466 468 469 470 472 473 474 477 478 479 481 483 484 485 486 487 488
 489 490 491 492 493 494 495 497 498 499 500 501 502 503 504 505 506 508
 509 510 511 513 515 516 517 518 519 521 525 527 528 529 530 532 534 535
 537 540 542 543 544 545 546 547 548 549 550 552 553 554 555 557 558 560
 561 563 565 566 567 568 569 570 572 574 575 576 577 579 580 581 583 584
 585 586 587 589 591 592 593 594 596 597 598 599] TEST: [  0   3   4   5  19  24  25  32  36  38  42  47  65  69  74  81 102 109
 116 121 139 140 149 151 159 163 168 172 179 180 184 186 198 209 210 223
 227 232 235 240 251 258 259 261 272 283 289 294 312 313 325 332 335 336
 339 340 341 352 354 358 359 366 369 370 375 376 379 389 392 403 405 409
 412 417 425 427 428 437 439 441 446 448 450 458 461 462 463 467 471 475
 476 480 482 496 507 512 514 520 522 523 524 526 531 533 536 538 539 541
 551 556 559 562 564 571 573 578 582 588 590 595]
train len 480 test len 120
TRAIN: [  0   2   3   4   5   6   7   9  10  11  12  13  14  17  18  19  20  21
  23  24  25  26  27  28  30  32  34  35  36  37  38  39  41  42  44  45
  46  47  48  50  53  55  56  58  59  63  64  65  66  67  68  69  70  71
  72  73  74  75  77  79  80  81  82  84  86  87  88  90  91  92  94  95
  96  97  98  99 100 101 102 103 106 107 108 109 111 113 114 116 118 120
 121 122 123 124 125 127 128 129 133 134 135 136 137 138 139 140 141 142
 143 144 145 146 147 149 150 151 152 153 154 155 156 157 159 160 161 163
 164 165 166 167 168 169 171 172 173 174 175 176 177 178 179 180 181 183
 184 186 188 189 191 192 193 194 195 196 197 198 199 200 202 203 204 205
 206 207 209 210 212 214 216 217 219 221 222 223 224 225 227 228 229 230
 231 232 233 234 235 236 237 238 239 240 241 242 243 244 245 246 249 250
 251 252 253 254 255 256 257 258 259 260 261 262 267 268 269 271 272 273
 274 275 276 277 278 279 281 283 284 286 287 288 289 290 291 292 294 295
 296 297 298 299 302 303 304 305 306 307 308 309 311 312 313 314 315 316
 317 318 319 320 323 324 325 326 328 330 331 332 335 336 337 338 339 340
 341 342 343 344 345 346 347 349 350 351 352 353 354 355 357 358 359 360
 361 362 363 366 367 368 369 370 371 372 373 374 375 376 377 378 379 380
 383 384 387 388 389 391 392 393 394 395 396 399 400 401 403 405 406 407
 409 410 411 412 413 414 415 416 417 419 420 421 422 423 424 425 426 427
 428 429 430 431 432 434 435 436 437 438 439 440 441 445 446 448 450 451
 453 454 457 458 459 460 461 462 463 464 466 467 468 469 471 472 474 475
 476 477 478 479 480 482 484 485 487 488 489 490 491 492 494 495 496 497
 498 499 502 503 504 505 506 507 508 509 510 511 512 514 515 516 518 519
 520 521 522 523 524 526 528 529 530 531 532 533 535 536 537 538 539 540
 541 543 546 547 548 550 551 552 553 554 555 556 557 558 559 560 561 562
 563 564 565 568 569 570 571 573 574 576 577 578 579 580 582 583 584 585
 587 588 589 590 591 592 594 595 596 597 598 599] TEST: [  1   8  15  16  22  29  31  33  40  43  49  51  52  54  57  60  61  62
  76  78  83  85  89  93 104 105 110 112 115 117 119 126 130 131 132 148
 158 162 170 182 185 187 190 201 208 211 213 215 218 220 226 247 248 263
 264 265 266 270 280 282 285 293 300 301 310 321 322 327 329 333 334 348
 356 364 365 381 382 385 386 390 397 398 402 404 408 418 433 442 443 444
 447 449 452 455 456 465 470 473 481 483 486 493 500 501 513 517 525 527
 534 542 544 545 549 566 567 572 575 581 586 593]
train len 480 test len 120
TRAIN: [  0   1   3   4   5   6   8  10  11  12  13  14  15  16  18  19  20  21
  22  24  25  26  27  28  29  31  32  33  36  37  38  39  40  41  42  43
  44  45  46  47  48  49  50  51  52  53  54  55  56  57  58  60  61  62
  63  64  65  66  69  70  71  72  73  74  75  76  77  78  79  80  81  83
  84  85  86  87  88  89  90  91  92  93  94  97  98 102 103 104 105 106
 108 109 110 111 112 113 114 115 116 117 119 120 121 124 125 126 127 129
 130 131 132 134 135 137 138 139 140 141 142 145 148 149 150 151 153 154
 155 157 158 159 161 162 163 164 165 166 167 168 169 170 171 172 173 175
 176 179 180 181 182 184 185 186 187 188 189 190 191 192 193 194 196 197
 198 199 201 202 203 204 206 207 208 209 210 211 213 214 215 216 217 218
 220 223 224 226 227 228 229 230 232 233 235 236 237 240 241 242 245 246
 247 248 250 251 252 256 257 258 259 261 262 263 264 265 266 267 268 269
 270 271 272 273 275 276 280 281 282 283 285 286 287 289 290 293 294 297
 299 300 301 302 304 305 306 307 308 309 310 311 312 313 316 318 319 320
 321 322 323 324 325 327 328 329 330 331 332 333 334 335 336 339 340 341
 342 343 344 345 346 347 348 349 351 352 354 356 358 359 360 361 362 363
 364 365 366 367 368 369 370 371 372 374 375 376 377 378 379 380 381 382
 385 386 387 388 389 390 392 393 395 397 398 400 401 402 403 404 405 406
 407 408 409 412 413 414 415 416 417 418 420 422 424 425 427 428 429 431
 433 434 436 437 438 439 441 442 443 444 445 446 447 448 449 450 452 454
 455 456 457 458 459 460 461 462 463 464 465 467 468 470 471 472 473 474
 475 476 478 479 480 481 482 483 484 486 488 490 491 493 495 496 499 500
 501 503 506 507 508 509 510 511 512 513 514 516 517 518 520 521 522 523
 524 525 526 527 529 530 531 532 533 534 535 536 537 538 539 540 541 542
 543 544 545 546 547 549 550 551 552 553 554 556 557 559 561 562 563 564
 565 566 567 569 570 571 572 573 574 575 577 578 579 581 582 583 584 585
 586 587 588 589 590 591 593 595 596 597 598 599] TEST: [  2   7   9  17  23  30  34  35  59  67  68  82  95  96  99 100 101 107
 118 122 123 128 133 136 143 144 146 147 152 156 160 174 177 178 183 195
 200 205 212 219 221 222 225 231 234 238 239 243 244 249 253 254 255 260
 274 277 278 279 284 288 291 292 295 296 298 303 314 315 317 326 337 338
 350 353 355 357 373 383 384 391 394 396 399 410 411 419 421 423 426 430
 432 435 440 451 453 466 469 477 485 487 489 492 494 497 498 502 504 505
 515 519 528 548 555 558 560 568 576 580 592 594]
train len 480 test len 120

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}22}]:} \PY{c+c1}{\PYZsh{}方法2}
         \PY{n}{kf\PYZus{}st} \PY{o}{=} \PY{n}{StratifiedKFold}\PY{p}{(}\PY{n}{n\PYZus{}splits}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{)}
         \PY{k}{for} \PY{n}{train\PYZus{}index}\PY{p}{,} \PY{n}{test\PYZus{}index} \PY{o+ow}{in} \PY{n}{kf\PYZus{}st}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{n}{data}\PY{p}{,} \PY{n}{data}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{subject}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}\PY{p}{:}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{TRAIN:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{train\PYZus{}index}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{TEST:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{test\PYZus{}index}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{train len}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{train\PYZus{}index}\PY{p}{)}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{test len}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{test\PYZus{}index}\PY{p}{)}\PY{p}{)}
             
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
TRAIN: [ 12  13  14  15  16  17  18  19  20  21  22  23  24  25  26  27  28  29
  30  31  32  33  34  35  36  37  38  39  40  41  42  43  44  45  46  47
  48  49  50  51  52  53  54  55  56  57  58  59  72  73  74  75  76  77
  78  79  80  81  82  83  84  85  86  87  88  89  90  91  92  93  94  95
  96  97  98  99 100 101 102 103 104 105 106 107 108 109 110 111 112 113
 114 115 116 117 118 119 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209
 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227
 228 229 230 231 232 233 234 235 236 237 238 239 252 253 254 255 256 257
 258 259 260 261 262 263 264 265 266 267 268 269 270 271 272 273 274 275
 276 277 278 279 280 281 282 283 284 285 286 287 288 289 290 291 292 293
 294 295 296 297 298 299 312 313 314 315 316 317 318 319 320 321 322 323
 324 325 326 327 328 329 330 331 332 333 334 335 336 337 338 339 340 341
 342 343 344 345 346 347 348 349 350 351 352 353 354 355 356 357 358 359
 372 373 374 375 376 377 378 379 380 381 382 383 384 385 386 387 388 389
 390 391 392 393 394 395 396 397 398 399 400 401 402 403 404 405 406 407
 408 409 410 411 412 413 414 415 416 417 418 419 432 433 434 435 436 437
 438 439 440 441 442 443 444 445 446 447 448 449 450 451 452 453 454 455
 456 457 458 459 460 461 462 463 464 465 466 467 468 469 470 471 472 473
 474 475 476 477 478 479 492 493 494 495 496 497 498 499 500 501 502 503
 504 505 506 507 508 509 510 511 512 513 514 515 516 517 518 519 520 521
 522 523 524 525 526 527 528 529 530 531 532 533 534 535 536 537 538 539
 552 553 554 555 556 557 558 559 560 561 562 563 564 565 566 567 568 569
 570 571 572 573 574 575 576 577 578 579 580 581 582 583 584 585 586 587
 588 589 590 591 592 593 594 595 596 597 598 599] TEST: [  0   1   2   3   4   5   6   7   8   9  10  11  60  61  62  63  64  65
  66  67  68  69  70  71 120 121 122 123 124 125 126 127 128 129 130 131
 180 181 182 183 184 185 186 187 188 189 190 191 240 241 242 243 244 245
 246 247 248 249 250 251 300 301 302 303 304 305 306 307 308 309 310 311
 360 361 362 363 364 365 366 367 368 369 370 371 420 421 422 423 424 425
 426 427 428 429 430 431 480 481 482 483 484 485 486 487 488 489 490 491
 540 541 542 543 544 545 546 547 548 549 550 551]
train len 480 test len 120
TRAIN: [  0   1   2   3   4   5   6   7   8   9  10  11  24  25  26  27  28  29
  30  31  32  33  34  35  36  37  38  39  40  41  42  43  44  45  46  47
  48  49  50  51  52  53  54  55  56  57  58  59  60  61  62  63  64  65
  66  67  68  69  70  71  84  85  86  87  88  89  90  91  92  93  94  95
  96  97  98  99 100 101 102 103 104 105 106 107 108 109 110 111 112 113
 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191 204 205 206 207 208 209
 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227
 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243 244 245
 246 247 248 249 250 251 264 265 266 267 268 269 270 271 272 273 274 275
 276 277 278 279 280 281 282 283 284 285 286 287 288 289 290 291 292 293
 294 295 296 297 298 299 300 301 302 303 304 305 306 307 308 309 310 311
 324 325 326 327 328 329 330 331 332 333 334 335 336 337 338 339 340 341
 342 343 344 345 346 347 348 349 350 351 352 353 354 355 356 357 358 359
 360 361 362 363 364 365 366 367 368 369 370 371 384 385 386 387 388 389
 390 391 392 393 394 395 396 397 398 399 400 401 402 403 404 405 406 407
 408 409 410 411 412 413 414 415 416 417 418 419 420 421 422 423 424 425
 426 427 428 429 430 431 444 445 446 447 448 449 450 451 452 453 454 455
 456 457 458 459 460 461 462 463 464 465 466 467 468 469 470 471 472 473
 474 475 476 477 478 479 480 481 482 483 484 485 486 487 488 489 490 491
 504 505 506 507 508 509 510 511 512 513 514 515 516 517 518 519 520 521
 522 523 524 525 526 527 528 529 530 531 532 533 534 535 536 537 538 539
 540 541 542 543 544 545 546 547 548 549 550 551 564 565 566 567 568 569
 570 571 572 573 574 575 576 577 578 579 580 581 582 583 584 585 586 587
 588 589 590 591 592 593 594 595 596 597 598 599] TEST: [ 12  13  14  15  16  17  18  19  20  21  22  23  72  73  74  75  76  77
  78  79  80  81  82  83 132 133 134 135 136 137 138 139 140 141 142 143
 192 193 194 195 196 197 198 199 200 201 202 203 252 253 254 255 256 257
 258 259 260 261 262 263 312 313 314 315 316 317 318 319 320 321 322 323
 372 373 374 375 376 377 378 379 380 381 382 383 432 433 434 435 436 437
 438 439 440 441 442 443 492 493 494 495 496 497 498 499 500 501 502 503
 552 553 554 555 556 557 558 559 560 561 562 563]
train len 480 test len 120
TRAIN: [  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  36  37  38  39  40  41  42  43  44  45  46  47
  48  49  50  51  52  53  54  55  56  57  58  59  60  61  62  63  64  65
  66  67  68  69  70  71  72  73  74  75  76  77  78  79  80  81  82  83
  96  97  98  99 100 101 102 103 104 105 106 107 108 109 110 111 112 113
 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131
 132 133 134 135 136 137 138 139 140 141 142 143 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197
 198 199 200 201 202 203 216 217 218 219 220 221 222 223 224 225 226 227
 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243 244 245
 246 247 248 249 250 251 252 253 254 255 256 257 258 259 260 261 262 263
 276 277 278 279 280 281 282 283 284 285 286 287 288 289 290 291 292 293
 294 295 296 297 298 299 300 301 302 303 304 305 306 307 308 309 310 311
 312 313 314 315 316 317 318 319 320 321 322 323 336 337 338 339 340 341
 342 343 344 345 346 347 348 349 350 351 352 353 354 355 356 357 358 359
 360 361 362 363 364 365 366 367 368 369 370 371 372 373 374 375 376 377
 378 379 380 381 382 383 396 397 398 399 400 401 402 403 404 405 406 407
 408 409 410 411 412 413 414 415 416 417 418 419 420 421 422 423 424 425
 426 427 428 429 430 431 432 433 434 435 436 437 438 439 440 441 442 443
 456 457 458 459 460 461 462 463 464 465 466 467 468 469 470 471 472 473
 474 475 476 477 478 479 480 481 482 483 484 485 486 487 488 489 490 491
 492 493 494 495 496 497 498 499 500 501 502 503 516 517 518 519 520 521
 522 523 524 525 526 527 528 529 530 531 532 533 534 535 536 537 538 539
 540 541 542 543 544 545 546 547 548 549 550 551 552 553 554 555 556 557
 558 559 560 561 562 563 576 577 578 579 580 581 582 583 584 585 586 587
 588 589 590 591 592 593 594 595 596 597 598 599] TEST: [ 24  25  26  27  28  29  30  31  32  33  34  35  84  85  86  87  88  89
  90  91  92  93  94  95 144 145 146 147 148 149 150 151 152 153 154 155
 204 205 206 207 208 209 210 211 212 213 214 215 264 265 266 267 268 269
 270 271 272 273 274 275 324 325 326 327 328 329 330 331 332 333 334 335
 384 385 386 387 388 389 390 391 392 393 394 395 444 445 446 447 448 449
 450 451 452 453 454 455 504 505 506 507 508 509 510 511 512 513 514 515
 564 565 566 567 568 569 570 571 572 573 574 575]
train len 480 test len 120
TRAIN: [  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  48  49  50  51  52  53  54  55  56  57  58  59  60  61  62  63  64  65
  66  67  68  69  70  71  72  73  74  75  76  77  78  79  80  81  82  83
  84  85  86  87  88  89  90  91  92  93  94  95 108 109 110 111 112 113
 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131
 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149
 150 151 152 153 154 155 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197
 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215
 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243 244 245
 246 247 248 249 250 251 252 253 254 255 256 257 258 259 260 261 262 263
 264 265 266 267 268 269 270 271 272 273 274 275 288 289 290 291 292 293
 294 295 296 297 298 299 300 301 302 303 304 305 306 307 308 309 310 311
 312 313 314 315 316 317 318 319 320 321 322 323 324 325 326 327 328 329
 330 331 332 333 334 335 348 349 350 351 352 353 354 355 356 357 358 359
 360 361 362 363 364 365 366 367 368 369 370 371 372 373 374 375 376 377
 378 379 380 381 382 383 384 385 386 387 388 389 390 391 392 393 394 395
 408 409 410 411 412 413 414 415 416 417 418 419 420 421 422 423 424 425
 426 427 428 429 430 431 432 433 434 435 436 437 438 439 440 441 442 443
 444 445 446 447 448 449 450 451 452 453 454 455 468 469 470 471 472 473
 474 475 476 477 478 479 480 481 482 483 484 485 486 487 488 489 490 491
 492 493 494 495 496 497 498 499 500 501 502 503 504 505 506 507 508 509
 510 511 512 513 514 515 528 529 530 531 532 533 534 535 536 537 538 539
 540 541 542 543 544 545 546 547 548 549 550 551 552 553 554 555 556 557
 558 559 560 561 562 563 564 565 566 567 568 569 570 571 572 573 574 575
 588 589 590 591 592 593 594 595 596 597 598 599] TEST: [ 36  37  38  39  40  41  42  43  44  45  46  47  96  97  98  99 100 101
 102 103 104 105 106 107 156 157 158 159 160 161 162 163 164 165 166 167
 216 217 218 219 220 221 222 223 224 225 226 227 276 277 278 279 280 281
 282 283 284 285 286 287 336 337 338 339 340 341 342 343 344 345 346 347
 396 397 398 399 400 401 402 403 404 405 406 407 456 457 458 459 460 461
 462 463 464 465 466 467 516 517 518 519 520 521 522 523 524 525 526 527
 576 577 578 579 580 581 582 583 584 585 586 587]
train len 480 test len 120
TRAIN: [  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  60  61  62  63  64  65
  66  67  68  69  70  71  72  73  74  75  76  77  78  79  80  81  82  83
  84  85  86  87  88  89  90  91  92  93  94  95  96  97  98  99 100 101
 102 103 104 105 106 107 120 121 122 123 124 125 126 127 128 129 130 131
 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149
 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167
 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197
 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215
 216 217 218 219 220 221 222 223 224 225 226 227 240 241 242 243 244 245
 246 247 248 249 250 251 252 253 254 255 256 257 258 259 260 261 262 263
 264 265 266 267 268 269 270 271 272 273 274 275 276 277 278 279 280 281
 282 283 284 285 286 287 300 301 302 303 304 305 306 307 308 309 310 311
 312 313 314 315 316 317 318 319 320 321 322 323 324 325 326 327 328 329
 330 331 332 333 334 335 336 337 338 339 340 341 342 343 344 345 346 347
 360 361 362 363 364 365 366 367 368 369 370 371 372 373 374 375 376 377
 378 379 380 381 382 383 384 385 386 387 388 389 390 391 392 393 394 395
 396 397 398 399 400 401 402 403 404 405 406 407 420 421 422 423 424 425
 426 427 428 429 430 431 432 433 434 435 436 437 438 439 440 441 442 443
 444 445 446 447 448 449 450 451 452 453 454 455 456 457 458 459 460 461
 462 463 464 465 466 467 480 481 482 483 484 485 486 487 488 489 490 491
 492 493 494 495 496 497 498 499 500 501 502 503 504 505 506 507 508 509
 510 511 512 513 514 515 516 517 518 519 520 521 522 523 524 525 526 527
 540 541 542 543 544 545 546 547 548 549 550 551 552 553 554 555 556 557
 558 559 560 561 562 563 564 565 566 567 568 569 570 571 572 573 574 575
 576 577 578 579 580 581 582 583 584 585 586 587] TEST: [ 48  49  50  51  52  53  54  55  56  57  58  59 108 109 110 111 112 113
 114 115 116 117 118 119 168 169 170 171 172 173 174 175 176 177 178 179
 228 229 230 231 232 233 234 235 236 237 238 239 288 289 290 291 292 293
 294 295 296 297 298 299 348 349 350 351 352 353 354 355 356 357 358 359
 408 409 410 411 412 413 414 415 416 417 418 419 468 469 470 471 472 473
 474 475 476 477 478 479 528 529 530 531 532 533 534 535 536 537 538 539
 588 589 590 591 592 593 594 595 596 597 598 599]
train len 480 test len 120

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}23}]:} \PY{c+c1}{\PYZsh{}方法3}
         \PY{n}{kf\PYZus{}group} \PY{o}{=} \PY{n}{GroupKFold}\PY{p}{(}\PY{n}{n\PYZus{}splits} \PY{o}{=} \PY{l+m+mi}{5}\PY{p}{)}
         \PY{k}{for} \PY{n}{train\PYZus{}index}\PY{p}{,} \PY{n}{test\PYZus{}index} \PY{o+ow}{in} \PY{n}{kf\PYZus{}group}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{n}{data}\PY{p}{,} \PY{n}{data}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{magnitude}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{data}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{subject}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}\PY{p}{:}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{TRAIN:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{train\PYZus{}index}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{TEST:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{test\PYZus{}index}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{train len}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{train\PYZus{}index}\PY{p}{)}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{test len}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{test\PYZus{}index}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
TRAIN: [  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 240 241 242 243 244 245 246 247 248 249 250 251 252 253 254 255 256 257
 258 259 260 261 262 263 264 265 266 267 268 269 270 271 272 273 274 275
 276 277 278 279 280 281 282 283 284 285 286 287 288 289 290 291 292 293
 294 295 296 297 298 299 300 301 302 303 304 305 306 307 308 309 310 311
 312 313 314 315 316 317 318 319 320 321 322 323 324 325 326 327 328 329
 330 331 332 333 334 335 336 337 338 339 340 341 342 343 344 345 346 347
 348 349 350 351 352 353 354 355 356 357 358 359 360 361 362 363 364 365
 366 367 368 369 370 371 372 373 374 375 376 377 378 379 380 381 382 383
 384 385 386 387 388 389 390 391 392 393 394 395 396 397 398 399 400 401
 402 403 404 405 406 407 408 409 410 411 412 413 414 415 416 417 418 419
 420 421 422 423 424 425 426 427 428 429 430 431 432 433 434 435 436 437
 438 439 440 441 442 443 444 445 446 447 448 449 450 451 452 453 454 455
 456 457 458 459 460 461 462 463 464 465 466 467 468 469 470 471 472 473
 474 475 476 477 478 479 540 541 542 543 544 545 546 547 548 549 550 551
 552 553 554 555 556 557 558 559 560 561 562 563 564 565 566 567 568 569
 570 571 572 573 574 575 576 577 578 579 580 581 582 583 584 585 586 587
 588 589 590 591 592 593 594 595 596 597 598 599] TEST: [180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197
 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215
 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233
 234 235 236 237 238 239 480 481 482 483 484 485 486 487 488 489 490 491
 492 493 494 495 496 497 498 499 500 501 502 503 504 505 506 507 508 509
 510 511 512 513 514 515 516 517 518 519 520 521 522 523 524 525 526 527
 528 529 530 531 532 533 534 535 536 537 538 539]
train len 480 test len 120
TRAIN: [  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59 120 121 122 123 124 125 126 127 128 129 130 131
 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149
 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167
 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185
 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203
 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221
 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239
 240 241 242 243 244 245 246 247 248 249 250 251 252 253 254 255 256 257
 258 259 260 261 262 263 264 265 266 267 268 269 270 271 272 273 274 275
 276 277 278 279 280 281 282 283 284 285 286 287 288 289 290 291 292 293
 294 295 296 297 298 299 300 301 302 303 304 305 306 307 308 309 310 311
 312 313 314 315 316 317 318 319 320 321 322 323 324 325 326 327 328 329
 330 331 332 333 334 335 336 337 338 339 340 341 342 343 344 345 346 347
 348 349 350 351 352 353 354 355 356 357 358 359 420 421 422 423 424 425
 426 427 428 429 430 431 432 433 434 435 436 437 438 439 440 441 442 443
 444 445 446 447 448 449 450 451 452 453 454 455 456 457 458 459 460 461
 462 463 464 465 466 467 468 469 470 471 472 473 474 475 476 477 478 479
 480 481 482 483 484 485 486 487 488 489 490 491 492 493 494 495 496 497
 498 499 500 501 502 503 504 505 506 507 508 509 510 511 512 513 514 515
 516 517 518 519 520 521 522 523 524 525 526 527 528 529 530 531 532 533
 534 535 536 537 538 539 540 541 542 543 544 545 546 547 548 549 550 551
 552 553 554 555 556 557 558 559 560 561 562 563 564 565 566 567 568 569
 570 571 572 573 574 575 576 577 578 579 580 581 582 583 584 585 586 587
 588 589 590 591 592 593 594 595 596 597 598 599] TEST: [ 60  61  62  63  64  65  66  67  68  69  70  71  72  73  74  75  76  77
  78  79  80  81  82  83  84  85  86  87  88  89  90  91  92  93  94  95
  96  97  98  99 100 101 102 103 104 105 106 107 108 109 110 111 112 113
 114 115 116 117 118 119 360 361 362 363 364 365 366 367 368 369 370 371
 372 373 374 375 376 377 378 379 380 381 382 383 384 385 386 387 388 389
 390 391 392 393 394 395 396 397 398 399 400 401 402 403 404 405 406 407
 408 409 410 411 412 413 414 415 416 417 418 419]
train len 480 test len 120
TRAIN: [  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 180 181 182 183 184 185
 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203
 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221
 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239
 240 241 242 243 244 245 246 247 248 249 250 251 252 253 254 255 256 257
 258 259 260 261 262 263 264 265 266 267 268 269 270 271 272 273 274 275
 276 277 278 279 280 281 282 283 284 285 286 287 288 289 290 291 292 293
 294 295 296 297 298 299 300 301 302 303 304 305 306 307 308 309 310 311
 312 313 314 315 316 317 318 319 320 321 322 323 324 325 326 327 328 329
 330 331 332 333 334 335 336 337 338 339 340 341 342 343 344 345 346 347
 348 349 350 351 352 353 354 355 356 357 358 359 360 361 362 363 364 365
 366 367 368 369 370 371 372 373 374 375 376 377 378 379 380 381 382 383
 384 385 386 387 388 389 390 391 392 393 394 395 396 397 398 399 400 401
 402 403 404 405 406 407 408 409 410 411 412 413 414 415 416 417 418 419
 480 481 482 483 484 485 486 487 488 489 490 491 492 493 494 495 496 497
 498 499 500 501 502 503 504 505 506 507 508 509 510 511 512 513 514 515
 516 517 518 519 520 521 522 523 524 525 526 527 528 529 530 531 532 533
 534 535 536 537 538 539 540 541 542 543 544 545 546 547 548 549 550 551
 552 553 554 555 556 557 558 559 560 561 562 563 564 565 566 567 568 569
 570 571 572 573 574 575 576 577 578 579 580 581 582 583 584 585 586 587
 588 589 590 591 592 593 594 595 596 597 598 599] TEST: [120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137
 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155
 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173
 174 175 176 177 178 179 420 421 422 423 424 425 426 427 428 429 430 431
 432 433 434 435 436 437 438 439 440 441 442 443 444 445 446 447 448 449
 450 451 452 453 454 455 456 457 458 459 460 461 462 463 464 465 466 467
 468 469 470 471 472 473 474 475 476 477 478 479]
train len 480 test len 120
TRAIN: [ 60  61  62  63  64  65  66  67  68  69  70  71  72  73  74  75  76  77
  78  79  80  81  82  83  84  85  86  87  88  89  90  91  92  93  94  95
  96  97  98  99 100 101 102 103 104 105 106 107 108 109 110 111 112 113
 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131
 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149
 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167
 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185
 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203
 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221
 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239
 240 241 242 243 244 245 246 247 248 249 250 251 252 253 254 255 256 257
 258 259 260 261 262 263 264 265 266 267 268 269 270 271 272 273 274 275
 276 277 278 279 280 281 282 283 284 285 286 287 288 289 290 291 292 293
 294 295 296 297 298 299 360 361 362 363 364 365 366 367 368 369 370 371
 372 373 374 375 376 377 378 379 380 381 382 383 384 385 386 387 388 389
 390 391 392 393 394 395 396 397 398 399 400 401 402 403 404 405 406 407
 408 409 410 411 412 413 414 415 416 417 418 419 420 421 422 423 424 425
 426 427 428 429 430 431 432 433 434 435 436 437 438 439 440 441 442 443
 444 445 446 447 448 449 450 451 452 453 454 455 456 457 458 459 460 461
 462 463 464 465 466 467 468 469 470 471 472 473 474 475 476 477 478 479
 480 481 482 483 484 485 486 487 488 489 490 491 492 493 494 495 496 497
 498 499 500 501 502 503 504 505 506 507 508 509 510 511 512 513 514 515
 516 517 518 519 520 521 522 523 524 525 526 527 528 529 530 531 532 533
 534 535 536 537 538 539 540 541 542 543 544 545 546 547 548 549 550 551
 552 553 554 555 556 557 558 559 560 561 562 563 564 565 566 567 568 569
 570 571 572 573 574 575 576 577 578 579 580 581 582 583 584 585 586 587
 588 589 590 591 592 593 594 595 596 597 598 599] TEST: [  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59 300 301 302 303 304 305 306 307 308 309 310 311
 312 313 314 315 316 317 318 319 320 321 322 323 324 325 326 327 328 329
 330 331 332 333 334 335 336 337 338 339 340 341 342 343 344 345 346 347
 348 349 350 351 352 353 354 355 356 357 358 359]
train len 480 test len 120
TRAIN: [  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197
 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215
 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233
 234 235 236 237 238 239 300 301 302 303 304 305 306 307 308 309 310 311
 312 313 314 315 316 317 318 319 320 321 322 323 324 325 326 327 328 329
 330 331 332 333 334 335 336 337 338 339 340 341 342 343 344 345 346 347
 348 349 350 351 352 353 354 355 356 357 358 359 360 361 362 363 364 365
 366 367 368 369 370 371 372 373 374 375 376 377 378 379 380 381 382 383
 384 385 386 387 388 389 390 391 392 393 394 395 396 397 398 399 400 401
 402 403 404 405 406 407 408 409 410 411 412 413 414 415 416 417 418 419
 420 421 422 423 424 425 426 427 428 429 430 431 432 433 434 435 436 437
 438 439 440 441 442 443 444 445 446 447 448 449 450 451 452 453 454 455
 456 457 458 459 460 461 462 463 464 465 466 467 468 469 470 471 472 473
 474 475 476 477 478 479 480 481 482 483 484 485 486 487 488 489 490 491
 492 493 494 495 496 497 498 499 500 501 502 503 504 505 506 507 508 509
 510 511 512 513 514 515 516 517 518 519 520 521 522 523 524 525 526 527
 528 529 530 531 532 533 534 535 536 537 538 539] TEST: [240 241 242 243 244 245 246 247 248 249 250 251 252 253 254 255 256 257
 258 259 260 261 262 263 264 265 266 267 268 269 270 271 272 273 274 275
 276 277 278 279 280 281 282 283 284 285 286 287 288 289 290 291 292 293
 294 295 296 297 298 299 540 541 542 543 544 545 546 547 548 549 550 551
 552 553 554 555 556 557 558 559 560 561 562 563 564 565 566 567 568 569
 570 571 572 573 574 575 576 577 578 579 580 581 582 583 584 585 586 587
 588 589 590 591 592 593 594 595 596 597 598 599]
train len 480 test len 120

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}24}]:} \PY{c+c1}{\PYZsh{}方法4}
         \PY{n}{kf\PYZus{}phase} \PY{o}{=} \PY{n}{GroupKFold}\PY{p}{(}\PY{n}{n\PYZus{}splits} \PY{o}{=} \PY{l+m+mi}{5}\PY{p}{)}
         \PY{k}{for} \PY{n}{train\PYZus{}index}\PY{p}{,} \PY{n}{test\PYZus{}index} \PY{o+ow}{in} \PY{n}{kf\PYZus{}phase}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{n}{data}\PY{p}{,} \PY{n}{data}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{magnitude}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{data}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{phase\PYZus{}diff}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}\PY{p}{:}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{TRAIN:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{train\PYZus{}index}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{TEST:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{test\PYZus{}index}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{train len}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{train\PYZus{}index}\PY{p}{)}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{test len}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{test\PYZus{}index}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
TRAIN: [  0   1   2   3   5   6   7   8  10  11  12  13  15  16  17  18  20  21
  22  23  25  26  27  28  30  31  32  33  35  36  37  38  40  41  42  43
  45  46  47  48  50  51  52  53  55  56  57  58  60  61  62  63  65  66
  67  68  70  71  72  73  75  76  77  78  80  81  82  83  85  86  87  88
  90  91  92  93  95  96  97  98 100 101 102 103 105 106 107 108 110 111
 112 113 115 116 117 118 120 121 122 123 125 126 127 128 130 131 132 133
 135 136 137 138 140 141 142 143 145 146 147 148 150 151 152 153 155 156
 157 158 160 161 162 163 165 166 167 168 170 171 172 173 175 176 177 178
 180 181 182 183 185 186 187 188 190 191 192 193 195 196 197 198 200 201
 202 203 205 206 207 208 210 211 212 213 215 216 217 218 220 221 222 223
 225 226 227 228 230 231 232 233 235 236 237 238 240 241 242 243 245 246
 247 248 250 251 252 253 255 256 257 258 260 261 262 263 265 266 267 268
 270 271 272 273 275 276 277 278 280 281 282 283 285 286 287 288 290 291
 292 293 295 296 297 298 300 301 302 303 305 306 307 308 310 311 312 313
 315 316 317 318 320 321 322 323 325 326 327 328 330 331 332 333 335 336
 337 338 340 341 342 343 345 346 347 348 350 351 352 353 355 356 357 358
 360 361 362 363 365 366 367 368 370 371 372 373 375 376 377 378 380 381
 382 383 385 386 387 388 390 391 392 393 395 396 397 398 400 401 402 403
 405 406 407 408 410 411 412 413 415 416 417 418 420 421 422 423 425 426
 427 428 430 431 432 433 435 436 437 438 440 441 442 443 445 446 447 448
 450 451 452 453 455 456 457 458 460 461 462 463 465 466 467 468 470 471
 472 473 475 476 477 478 480 481 482 483 485 486 487 488 490 491 492 493
 495 496 497 498 500 501 502 503 505 506 507 508 510 511 512 513 515 516
 517 518 520 521 522 523 525 526 527 528 530 531 532 533 535 536 537 538
 540 541 542 543 545 546 547 548 550 551 552 553 555 556 557 558 560 561
 562 563 565 566 567 568 570 571 572 573 575 576 577 578 580 581 582 583
 585 586 587 588 590 591 592 593 595 596 597 598] TEST: [  4   9  14  19  24  29  34  39  44  49  54  59  64  69  74  79  84  89
  94  99 104 109 114 119 124 129 134 139 144 149 154 159 164 169 174 179
 184 189 194 199 204 209 214 219 224 229 234 239 244 249 254 259 264 269
 274 279 284 289 294 299 304 309 314 319 324 329 334 339 344 349 354 359
 364 369 374 379 384 389 394 399 404 409 414 419 424 429 434 439 444 449
 454 459 464 469 474 479 484 489 494 499 504 509 514 519 524 529 534 539
 544 549 554 559 564 569 574 579 584 589 594 599]
train len 480 test len 120
TRAIN: [  0   1   2   4   5   6   7   9  10  11  12  14  15  16  17  19  20  21
  22  24  25  26  27  29  30  31  32  34  35  36  37  39  40  41  42  44
  45  46  47  49  50  51  52  54  55  56  57  59  60  61  62  64  65  66
  67  69  70  71  72  74  75  76  77  79  80  81  82  84  85  86  87  89
  90  91  92  94  95  96  97  99 100 101 102 104 105 106 107 109 110 111
 112 114 115 116 117 119 120 121 122 124 125 126 127 129 130 131 132 134
 135 136 137 139 140 141 142 144 145 146 147 149 150 151 152 154 155 156
 157 159 160 161 162 164 165 166 167 169 170 171 172 174 175 176 177 179
 180 181 182 184 185 186 187 189 190 191 192 194 195 196 197 199 200 201
 202 204 205 206 207 209 210 211 212 214 215 216 217 219 220 221 222 224
 225 226 227 229 230 231 232 234 235 236 237 239 240 241 242 244 245 246
 247 249 250 251 252 254 255 256 257 259 260 261 262 264 265 266 267 269
 270 271 272 274 275 276 277 279 280 281 282 284 285 286 287 289 290 291
 292 294 295 296 297 299 300 301 302 304 305 306 307 309 310 311 312 314
 315 316 317 319 320 321 322 324 325 326 327 329 330 331 332 334 335 336
 337 339 340 341 342 344 345 346 347 349 350 351 352 354 355 356 357 359
 360 361 362 364 365 366 367 369 370 371 372 374 375 376 377 379 380 381
 382 384 385 386 387 389 390 391 392 394 395 396 397 399 400 401 402 404
 405 406 407 409 410 411 412 414 415 416 417 419 420 421 422 424 425 426
 427 429 430 431 432 434 435 436 437 439 440 441 442 444 445 446 447 449
 450 451 452 454 455 456 457 459 460 461 462 464 465 466 467 469 470 471
 472 474 475 476 477 479 480 481 482 484 485 486 487 489 490 491 492 494
 495 496 497 499 500 501 502 504 505 506 507 509 510 511 512 514 515 516
 517 519 520 521 522 524 525 526 527 529 530 531 532 534 535 536 537 539
 540 541 542 544 545 546 547 549 550 551 552 554 555 556 557 559 560 561
 562 564 565 566 567 569 570 571 572 574 575 576 577 579 580 581 582 584
 585 586 587 589 590 591 592 594 595 596 597 599] TEST: [  3   8  13  18  23  28  33  38  43  48  53  58  63  68  73  78  83  88
  93  98 103 108 113 118 123 128 133 138 143 148 153 158 163 168 173 178
 183 188 193 198 203 208 213 218 223 228 233 238 243 248 253 258 263 268
 273 278 283 288 293 298 303 308 313 318 323 328 333 338 343 348 353 358
 363 368 373 378 383 388 393 398 403 408 413 418 423 428 433 438 443 448
 453 458 463 468 473 478 483 488 493 498 503 508 513 518 523 528 533 538
 543 548 553 558 563 568 573 578 583 588 593 598]
train len 480 test len 120
TRAIN: [  0   1   3   4   5   6   8   9  10  11  13  14  15  16  18  19  20  21
  23  24  25  26  28  29  30  31  33  34  35  36  38  39  40  41  43  44
  45  46  48  49  50  51  53  54  55  56  58  59  60  61  63  64  65  66
  68  69  70  71  73  74  75  76  78  79  80  81  83  84  85  86  88  89
  90  91  93  94  95  96  98  99 100 101 103 104 105 106 108 109 110 111
 113 114 115 116 118 119 120 121 123 124 125 126 128 129 130 131 133 134
 135 136 138 139 140 141 143 144 145 146 148 149 150 151 153 154 155 156
 158 159 160 161 163 164 165 166 168 169 170 171 173 174 175 176 178 179
 180 181 183 184 185 186 188 189 190 191 193 194 195 196 198 199 200 201
 203 204 205 206 208 209 210 211 213 214 215 216 218 219 220 221 223 224
 225 226 228 229 230 231 233 234 235 236 238 239 240 241 243 244 245 246
 248 249 250 251 253 254 255 256 258 259 260 261 263 264 265 266 268 269
 270 271 273 274 275 276 278 279 280 281 283 284 285 286 288 289 290 291
 293 294 295 296 298 299 300 301 303 304 305 306 308 309 310 311 313 314
 315 316 318 319 320 321 323 324 325 326 328 329 330 331 333 334 335 336
 338 339 340 341 343 344 345 346 348 349 350 351 353 354 355 356 358 359
 360 361 363 364 365 366 368 369 370 371 373 374 375 376 378 379 380 381
 383 384 385 386 388 389 390 391 393 394 395 396 398 399 400 401 403 404
 405 406 408 409 410 411 413 414 415 416 418 419 420 421 423 424 425 426
 428 429 430 431 433 434 435 436 438 439 440 441 443 444 445 446 448 449
 450 451 453 454 455 456 458 459 460 461 463 464 465 466 468 469 470 471
 473 474 475 476 478 479 480 481 483 484 485 486 488 489 490 491 493 494
 495 496 498 499 500 501 503 504 505 506 508 509 510 511 513 514 515 516
 518 519 520 521 523 524 525 526 528 529 530 531 533 534 535 536 538 539
 540 541 543 544 545 546 548 549 550 551 553 554 555 556 558 559 560 561
 563 564 565 566 568 569 570 571 573 574 575 576 578 579 580 581 583 584
 585 586 588 589 590 591 593 594 595 596 598 599] TEST: [  2   7  12  17  22  27  32  37  42  47  52  57  62  67  72  77  82  87
  92  97 102 107 112 117 122 127 132 137 142 147 152 157 162 167 172 177
 182 187 192 197 202 207 212 217 222 227 232 237 242 247 252 257 262 267
 272 277 282 287 292 297 302 307 312 317 322 327 332 337 342 347 352 357
 362 367 372 377 382 387 392 397 402 407 412 417 422 427 432 437 442 447
 452 457 462 467 472 477 482 487 492 497 502 507 512 517 522 527 532 537
 542 547 552 557 562 567 572 577 582 587 592 597]
train len 480 test len 120
TRAIN: [  0   2   3   4   5   7   8   9  10  12  13  14  15  17  18  19  20  22
  23  24  25  27  28  29  30  32  33  34  35  37  38  39  40  42  43  44
  45  47  48  49  50  52  53  54  55  57  58  59  60  62  63  64  65  67
  68  69  70  72  73  74  75  77  78  79  80  82  83  84  85  87  88  89
  90  92  93  94  95  97  98  99 100 102 103 104 105 107 108 109 110 112
 113 114 115 117 118 119 120 122 123 124 125 127 128 129 130 132 133 134
 135 137 138 139 140 142 143 144 145 147 148 149 150 152 153 154 155 157
 158 159 160 162 163 164 165 167 168 169 170 172 173 174 175 177 178 179
 180 182 183 184 185 187 188 189 190 192 193 194 195 197 198 199 200 202
 203 204 205 207 208 209 210 212 213 214 215 217 218 219 220 222 223 224
 225 227 228 229 230 232 233 234 235 237 238 239 240 242 243 244 245 247
 248 249 250 252 253 254 255 257 258 259 260 262 263 264 265 267 268 269
 270 272 273 274 275 277 278 279 280 282 283 284 285 287 288 289 290 292
 293 294 295 297 298 299 300 302 303 304 305 307 308 309 310 312 313 314
 315 317 318 319 320 322 323 324 325 327 328 329 330 332 333 334 335 337
 338 339 340 342 343 344 345 347 348 349 350 352 353 354 355 357 358 359
 360 362 363 364 365 367 368 369 370 372 373 374 375 377 378 379 380 382
 383 384 385 387 388 389 390 392 393 394 395 397 398 399 400 402 403 404
 405 407 408 409 410 412 413 414 415 417 418 419 420 422 423 424 425 427
 428 429 430 432 433 434 435 437 438 439 440 442 443 444 445 447 448 449
 450 452 453 454 455 457 458 459 460 462 463 464 465 467 468 469 470 472
 473 474 475 477 478 479 480 482 483 484 485 487 488 489 490 492 493 494
 495 497 498 499 500 502 503 504 505 507 508 509 510 512 513 514 515 517
 518 519 520 522 523 524 525 527 528 529 530 532 533 534 535 537 538 539
 540 542 543 544 545 547 548 549 550 552 553 554 555 557 558 559 560 562
 563 564 565 567 568 569 570 572 573 574 575 577 578 579 580 582 583 584
 585 587 588 589 590 592 593 594 595 597 598 599] TEST: [  1   6  11  16  21  26  31  36  41  46  51  56  61  66  71  76  81  86
  91  96 101 106 111 116 121 126 131 136 141 146 151 156 161 166 171 176
 181 186 191 196 201 206 211 216 221 226 231 236 241 246 251 256 261 266
 271 276 281 286 291 296 301 306 311 316 321 326 331 336 341 346 351 356
 361 366 371 376 381 386 391 396 401 406 411 416 421 426 431 436 441 446
 451 456 461 466 471 476 481 486 491 496 501 506 511 516 521 526 531 536
 541 546 551 556 561 566 571 576 581 586 591 596]
train len 480 test len 120
TRAIN: [  1   2   3   4   6   7   8   9  11  12  13  14  16  17  18  19  21  22
  23  24  26  27  28  29  31  32  33  34  36  37  38  39  41  42  43  44
  46  47  48  49  51  52  53  54  56  57  58  59  61  62  63  64  66  67
  68  69  71  72  73  74  76  77  78  79  81  82  83  84  86  87  88  89
  91  92  93  94  96  97  98  99 101 102 103 104 106 107 108 109 111 112
 113 114 116 117 118 119 121 122 123 124 126 127 128 129 131 132 133 134
 136 137 138 139 141 142 143 144 146 147 148 149 151 152 153 154 156 157
 158 159 161 162 163 164 166 167 168 169 171 172 173 174 176 177 178 179
 181 182 183 184 186 187 188 189 191 192 193 194 196 197 198 199 201 202
 203 204 206 207 208 209 211 212 213 214 216 217 218 219 221 222 223 224
 226 227 228 229 231 232 233 234 236 237 238 239 241 242 243 244 246 247
 248 249 251 252 253 254 256 257 258 259 261 262 263 264 266 267 268 269
 271 272 273 274 276 277 278 279 281 282 283 284 286 287 288 289 291 292
 293 294 296 297 298 299 301 302 303 304 306 307 308 309 311 312 313 314
 316 317 318 319 321 322 323 324 326 327 328 329 331 332 333 334 336 337
 338 339 341 342 343 344 346 347 348 349 351 352 353 354 356 357 358 359
 361 362 363 364 366 367 368 369 371 372 373 374 376 377 378 379 381 382
 383 384 386 387 388 389 391 392 393 394 396 397 398 399 401 402 403 404
 406 407 408 409 411 412 413 414 416 417 418 419 421 422 423 424 426 427
 428 429 431 432 433 434 436 437 438 439 441 442 443 444 446 447 448 449
 451 452 453 454 456 457 458 459 461 462 463 464 466 467 468 469 471 472
 473 474 476 477 478 479 481 482 483 484 486 487 488 489 491 492 493 494
 496 497 498 499 501 502 503 504 506 507 508 509 511 512 513 514 516 517
 518 519 521 522 523 524 526 527 528 529 531 532 533 534 536 537 538 539
 541 542 543 544 546 547 548 549 551 552 553 554 556 557 558 559 561 562
 563 564 566 567 568 569 571 572 573 574 576 577 578 579 581 582 583 584
 586 587 588 589 591 592 593 594 596 597 598 599] TEST: [  0   5  10  15  20  25  30  35  40  45  50  55  60  65  70  75  80  85
  90  95 100 105 110 115 120 125 130 135 140 145 150 155 160 165 170 175
 180 185 190 195 200 205 210 215 220 225 230 235 240 245 250 255 260 265
 270 275 280 285 290 295 300 305 310 315 320 325 330 335 340 345 350 355
 360 365 370 375 380 385 390 395 400 405 410 415 420 425 430 435 440 445
 450 455 460 465 470 475 480 485 490 495 500 505 510 515 520 525 530 535
 540 545 550 555 560 565 570 575 580 585 590 595]
train len 480 test len 120

    \end{Verbatim}

    \subsection{OLSによる推定}\label{olsux306bux3088ux308bux63a8ux5b9a}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}37}]:} \PY{c+c1}{\PYZsh{}indexで5Foldに分ける}
         \PY{n}{cv\PYZus{}rand\PYZus{}results} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{cv\PYZus{}rand\PYZus{}preds} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{cv\PYZus{}rand\PYZus{}scores\PYZus{}rmse} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{cv\PYZus{}rand\PYZus{}scores\PYZus{}mae} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         
         \PY{n}{cv\PYZus{}st\PYZus{}results} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{cv\PYZus{}st\PYZus{}preds} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{cv\PYZus{}st\PYZus{}scores\PYZus{}rmse} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{cv\PYZus{}st\PYZus{}scores\PYZus{}mae} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         
         \PY{n}{cv\PYZus{}group\PYZus{}results} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{cv\PYZus{}group\PYZus{}preds} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{cv\PYZus{}group\PYZus{}scores\PYZus{}rmse} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{cv\PYZus{}group\PYZus{}scores\PYZus{}mae} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         
         \PY{n}{cv\PYZus{}phase\PYZus{}results} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{cv\PYZus{}phase\PYZus{}preds} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{cv\PYZus{}phase\PYZus{}scores\PYZus{}rmse} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{cv\PYZus{}phase\PYZus{}scores\PYZus{}mae} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         
         \PY{k}{for} \PY{n}{train\PYZus{}index}\PY{p}{,} \PY{n}{test\PYZus{}index} \PY{o+ow}{in} \PY{n}{kf\PYZus{}random}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{n}{data}\PY{p}{)}\PY{p}{:}
             \PY{n}{data\PYZus{}train} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{train\PYZus{}index}\PY{p}{,}\PY{p}{:}\PY{p}{]}
             \PY{n}{data\PYZus{}test} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{test\PYZus{}index}\PY{p}{,}\PY{p}{:}\PY{p}{]}
             
             \PY{n}{results} \PY{o}{=} \PY{n}{smf}\PY{o}{.}\PY{n}{ols}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{magnitude \PYZti{} phase\PYZus{}diff}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{data} \PY{o}{=} \PY{n}{data}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{p}{)}
             \PY{n}{cv\PYZus{}rand\PYZus{}results}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{results}\PY{p}{)}
             
             \PY{n}{y\PYZus{}pred} \PY{o}{=} \PY{n}{results}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{data\PYZus{}test}\PY{p}{)}
             \PY{n}{cv\PYZus{}rand\PYZus{}preds}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{y\PYZus{}pred}\PY{p}{)}
             
             \PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{data\PYZus{}test}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{magnitude}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}
             \PY{n}{rmse} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{mean\PYZus{}squared\PYZus{}error}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{)}\PY{p}{)}
             \PY{n}{cv\PYZus{}rand\PYZus{}scores\PYZus{}rmse}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{rmse}\PY{p}{)}
             \PY{n}{mae} \PY{o}{=} \PY{n}{mean\PYZus{}absolute\PYZus{}error}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{)}
             \PY{n}{cv\PYZus{}rand\PYZus{}scores\PYZus{}mae}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{mae}\PY{p}{)}
             
         \PY{k}{for} \PY{n}{train\PYZus{}index}\PY{p}{,} \PY{n}{test\PYZus{}index} \PY{o+ow}{in} \PY{n}{kf\PYZus{}st}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{n}{data}\PY{p}{,} \PY{n}{data}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{subject}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}\PY{p}{:}
             \PY{n}{data\PYZus{}train} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{train\PYZus{}index}\PY{p}{,}\PY{p}{:}\PY{p}{]}
             \PY{n}{data\PYZus{}test} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{test\PYZus{}index}\PY{p}{,}\PY{p}{:}\PY{p}{]}
             
             \PY{n}{results} \PY{o}{=} \PY{n}{smf}\PY{o}{.}\PY{n}{ols}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{magnitude \PYZti{} phase\PYZus{}diff}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{data} \PY{o}{=} \PY{n}{data}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{p}{)}
             \PY{n}{cv\PYZus{}st\PYZus{}results}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{results}\PY{p}{)}
             
             \PY{n}{y\PYZus{}pred} \PY{o}{=} \PY{n}{results}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{data\PYZus{}test}\PY{p}{)}
             \PY{n}{cv\PYZus{}st\PYZus{}preds}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{y\PYZus{}pred}\PY{p}{)}
             
             \PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{data\PYZus{}test}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{magnitude}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}
             \PY{n}{rmse} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{mean\PYZus{}squared\PYZus{}error}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{)}\PY{p}{)}
             \PY{n}{cv\PYZus{}st\PYZus{}scores\PYZus{}rmse}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{rmse}\PY{p}{)}
             \PY{n}{mae} \PY{o}{=} \PY{n}{mean\PYZus{}absolute\PYZus{}error}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{)}
             \PY{n}{cv\PYZus{}st\PYZus{}scores\PYZus{}mae}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{mae}\PY{p}{)}
             
         \PY{k}{for} \PY{n}{train\PYZus{}index}\PY{p}{,} \PY{n}{test\PYZus{}index} \PY{o+ow}{in} \PY{n}{kf\PYZus{}group}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{n}{data}\PY{p}{,} \PY{n}{data}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{magnitude}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{data}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{subject}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}\PY{p}{:}
             \PY{n}{data\PYZus{}train} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{train\PYZus{}index}\PY{p}{,}\PY{p}{:}\PY{p}{]}
             \PY{n}{data\PYZus{}test} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{test\PYZus{}index}\PY{p}{,}\PY{p}{:}\PY{p}{]}
             
             \PY{n}{results} \PY{o}{=} \PY{n}{smf}\PY{o}{.}\PY{n}{ols}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{magnitude \PYZti{} phase\PYZus{}diff}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{data} \PY{o}{=} \PY{n}{data}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{p}{)}
             \PY{n}{cv\PYZus{}group\PYZus{}results}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{results}\PY{p}{)}
             
             \PY{n}{y\PYZus{}pred} \PY{o}{=} \PY{n}{results}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{data\PYZus{}test}\PY{p}{)}
             \PY{n}{cv\PYZus{}group\PYZus{}preds}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{y\PYZus{}pred}\PY{p}{)}
             
             \PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{data\PYZus{}test}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{magnitude}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}
             \PY{n}{rmse} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{mean\PYZus{}squared\PYZus{}error}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{)}\PY{p}{)}
             \PY{n}{cv\PYZus{}group\PYZus{}scores\PYZus{}rmse}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{rmse}\PY{p}{)}
             \PY{n}{mae} \PY{o}{=} \PY{n}{mean\PYZus{}absolute\PYZus{}error}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{)}
             \PY{n}{cv\PYZus{}group\PYZus{}scores\PYZus{}mae}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{mae}\PY{p}{)}
             
                 
         \PY{k}{for} \PY{n}{train\PYZus{}index}\PY{p}{,} \PY{n}{test\PYZus{}index} \PY{o+ow}{in} \PY{n}{kf\PYZus{}phase}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{n}{data}\PY{p}{,} \PY{n}{data}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{magnitude}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{data}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{phase\PYZus{}diff}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}\PY{p}{:}
             \PY{n}{data\PYZus{}train} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{train\PYZus{}index}\PY{p}{,}\PY{p}{:}\PY{p}{]}
             \PY{n}{data\PYZus{}test} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{test\PYZus{}index}\PY{p}{,}\PY{p}{:}\PY{p}{]}
             
             \PY{n}{results} \PY{o}{=} \PY{n}{smf}\PY{o}{.}\PY{n}{ols}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{magnitude \PYZti{} phase\PYZus{}diff}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{data} \PY{o}{=} \PY{n}{data}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{p}{)}
             \PY{n}{cv\PYZus{}phase\PYZus{}results}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{results}\PY{p}{)}
             
             \PY{n}{y\PYZus{}pred} \PY{o}{=} \PY{n}{results}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{data\PYZus{}test}\PY{p}{)}
             \PY{n}{cv\PYZus{}phase\PYZus{}preds}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{y\PYZus{}pred}\PY{p}{)}
             
             \PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{data\PYZus{}test}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{magnitude}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}
             \PY{n}{rmse} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{mean\PYZus{}squared\PYZus{}error}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{)}\PY{p}{)}
             \PY{n}{cv\PYZus{}phase\PYZus{}scores\PYZus{}rmse}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{rmse}\PY{p}{)}
             \PY{n}{mae} \PY{o}{=} \PY{n}{mean\PYZus{}absolute\PYZus{}error}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{)}
             \PY{n}{cv\PYZus{}phase\PYZus{}scores\PYZus{}mae}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{mae}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}38}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{cv\PYZus{}randでの平方二乗誤差}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{cv\PYZus{}rand\PYZus{}scores\PYZus{}rmse}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{cv\PYZus{}stでの平方二乗誤差}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{cv\PYZus{}st\PYZus{}scores\PYZus{}rmse}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{cv\PYZus{}groupでの平方二乗誤差}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{cv\PYZus{}group\PYZus{}scores\PYZus{}rmse}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{cv\PYZus{}phaseでの平方二乗誤差}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{cv\PYZus{}phase\PYZus{}scores\PYZus{}rmse}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
cv\_randでの平方二乗誤差
[1.6232611734150981, 1.7051365105102447, 1.6691093584338685, 1.4883389006782413, 1.48693503113913]
cv\_stでの平方二乗誤差
[1.719859271916086, 1.575311060630391, 1.478600246768052, 1.5788674550291688, 1.6235516295675267]
cv\_groupでの平方二乗誤差
[1.324526439101458, 1.8330842489193921, 1.7213794097730344, 1.6610562392545087, 1.384810031460029]
cv\_phaseでの平方二乗誤差
[1.695665778553634, 1.7284595689608988, 1.5540429606902937, 1.4357790585955488, 1.5540771970019394]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}39}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{cv\PYZus{}randscore\PYZus{}rmseの平均}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{cv\PYZus{}rand\PYZus{}scores\PYZus{}rmse}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{cv\PYZus{}stscore\PYZus{}rmseの平均}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{cv\PYZus{}st\PYZus{}scores\PYZus{}rmse}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{cv\PYZus{}group\PYZus{}score\PYZus{}rmseの平均}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{cv\PYZus{}group\PYZus{}scores\PYZus{}rmse}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{cv\PYZus{}phase\PYZus{}score\PYZus{}rmseの平均}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{cv\PYZus{}phase\PYZus{}scores\PYZus{}rmse}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
cv\_randscore\_rmseの平均
1.5945561948353166
cv\_stscore\_rmseの平均
1.595237932782245
cv\_group\_score\_rmseの平均
1.5849712737016846
cv\_phase\_score\_rmseの平均
1.593604912760463

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}40}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{cv\PYZus{}randでの絶対平均誤差}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{cv\PYZus{}rand\PYZus{}scores\PYZus{}mae}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{cv\PYZus{}stでの絶対平均誤差}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{cv\PYZus{}st\PYZus{}scores\PYZus{}mae}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{cv\PYZus{}groupでの絶対平均誤差}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{cv\PYZus{}group\PYZus{}scores\PYZus{}mae}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{cv\PYZus{}phaseでの絶対平均誤差}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{cv\PYZus{}phase\PYZus{}scores\PYZus{}mae}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
cv\_randでの絶対平均誤差
[1.3580909090909083, 1.4564280303030297, 1.4175035353535346, 1.2064904040404036, 1.2327287037037034]
cv\_stでの絶対平均誤差
[1.4561466329966326, 1.297175589225589, 1.2319676767676764, 1.3461941077441073, 1.3397575757575744]
cv\_groupでの絶対平均誤差
[1.1035277777777774, 1.5467146464646477, 1.491807912457908, 1.3500966329966329, 1.1790946127946134]
cv\_phaseでの絶対平均誤差
[1.419022053872053, 1.4331436026936022, 1.303811784511784, 1.209577777777777, 1.305686363636363]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}41}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{cv\PYZus{}randscore\PYZus{}maeの平均}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{cv\PYZus{}rand\PYZus{}scores\PYZus{}mae}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{cv\PYZus{}stscore\PYZus{}maeの平均}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{cv\PYZus{}st\PYZus{}scores\PYZus{}mae}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{cv\PYZus{}groupscore\PYZus{}maeの平均}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{cv\PYZus{}group\PYZus{}scores\PYZus{}mae}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{cv\PYZus{}phasescore\PYZus{}maeの平均}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{cv\PYZus{}phase\PYZus{}scores\PYZus{}mae}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
cv\_randscore\_maeの平均
1.3342483164983159
cv\_stscore\_maeの平均
1.334248316498316
cv\_groupscore\_maeの平均
1.3342483164983157
cv\_phasescore\_maeの平均
1.3342483164983157

    \end{Verbatim}

    \subsection{FWLSによる推定}\label{fwlsux306bux3088ux308bux63a8ux5b9a}

重みのつけ方が良くわからない.とりあえず推定量をそのまま使う

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}19}]:} \PY{n}{data\PYZus{}fwls} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{merge}\PY{p}{(}\PY{n}{data}\PY{p}{,} \PY{n}{phase\PYZus{}diff\PYZus{}var}\PY{p}{,} \PY{n}{on}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{phase\PYZus{}diff}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{data\PYZus{}fwls}\PY{o}{.}\PY{n}{columns} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{subject}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{phase\PYZus{}diff}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{magnitude}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{estimated\PYZus{}var}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
         \PY{n}{data\PYZus{}fwls}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}19}]:}   subject  phase\_diff  magnitude  estimated\_var
         0     永井君           0        5.5         1.7026
         1     永井君           0        6.5         1.7026
         2     永井君           0        6.5         1.7026
         3     永井君           0        4.0         1.7026
         4     横山君           0        6.0         1.7026
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}20}]:} \PY{n}{w} \PY{o}{=} \PY{n}{data\PYZus{}fwls}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{estimated\PYZus{}var}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}
         \PY{n}{results} \PY{o}{=} \PY{n}{smf}\PY{o}{.}\PY{n}{wls}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{magnitude \PYZti{} phase\PYZus{}diff}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{data} \PY{o}{=} \PY{n}{data\PYZus{}fwls}\PY{p}{,} \PY{n}{weights}\PY{o}{=}\PY{l+m+mf}{1.}\PY{o}{/}\PY{n}{w}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{results}\PY{o}{.}\PY{n}{summary}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
                            WLS Regression Results                            
==============================================================================
Dep. Variable:              magnitude   R-squared:                       0.065
Model:                            WLS   Adj. R-squared:                  0.063
Method:                 Least Squares   F-statistic:                     48.17
Date:                Mon, 14 May 2018   Prob (F-statistic):           8.96e-12
Time:                        16:31:39   Log-Likelihood:                -1312.0
No. Observations:                 700   AIC:                             2628.
Df Residuals:                     698   BIC:                             2637.
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P>|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept      4.2354      0.099     42.722      0.000       4.041       4.430
phase\_diff    -0.0070      0.001     -6.940      0.000      -0.009      -0.005
==============================================================================
Omnibus:                       49.346   Durbin-Watson:                   1.120
Prob(Omnibus):                  0.000   Jarque-Bera (JB):               20.868
Skew:                           0.191   Prob(JB):                     2.94e-05
Kurtosis:                       2.245   Cond. No.                         164.
==============================================================================

Warnings:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}27}]:} \PY{n}{cv\PYZus{}results} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{cv\PYZus{}preds} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{cv\PYZus{}scores\PYZus{}rmse} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{cv\PYZus{}scores\PYZus{}mae} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         
         \PY{k}{for} \PY{n}{train\PYZus{}index}\PY{p}{,} \PY{n}{test\PYZus{}index} \PY{o+ow}{in} \PY{n}{kf}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{n}{data}\PY{p}{)}\PY{p}{:}
             \PY{n}{data\PYZus{}train} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{train\PYZus{}index}\PY{p}{,}\PY{p}{:}\PY{p}{]}
             \PY{n}{data\PYZus{}test} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{test\PYZus{}index}\PY{p}{,}\PY{p}{:}\PY{p}{]}
             
             \PY{n}{phase\PYZus{}diff\PYZus{}var} \PY{o}{=} \PY{n}{data\PYZus{}train}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{phase\PYZus{}diff}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{var}\PY{p}{(}\PY{p}{)}
             \PY{n}{phase\PYZus{}diff\PYZus{}var}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{phase\PYZus{}diff}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{phase\PYZus{}diff\PYZus{}var}\PY{o}{.}\PY{n}{index}
         
             
             \PY{n}{data\PYZus{}train} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{merge}\PY{p}{(}\PY{n}{data\PYZus{}train}\PY{p}{,} \PY{n}{phase\PYZus{}diff\PYZus{}var}\PY{p}{,} \PY{n}{on}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{phase\PYZus{}diff}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
             \PY{n}{data\PYZus{}train}\PY{o}{.}\PY{n}{columns} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{subject}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{phase\PYZus{}diff}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{magnitude}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{estimated\PYZus{}var}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
             
             
             \PY{n}{w} \PY{o}{=} \PY{n}{data\PYZus{}train}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{estimated\PYZus{}var}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}
             
             \PY{n}{results} \PY{o}{=} \PY{n}{smf}\PY{o}{.}\PY{n}{wls}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{magnitude \PYZti{} phase\PYZus{}diff}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{data} \PY{o}{=} \PY{n}{data\PYZus{}train}\PY{p}{,} \PY{n}{weights}\PY{o}{=}\PY{l+m+mf}{1.}\PY{o}{/}\PY{n}{w}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{p}{)}
             \PY{n}{cv\PYZus{}results}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{results}\PY{p}{)}
             
             \PY{n}{y\PYZus{}pred} \PY{o}{=} \PY{n}{results}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{data\PYZus{}test}\PY{p}{)}
             \PY{n}{cv\PYZus{}preds}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{y\PYZus{}pred}\PY{p}{)}
             
             \PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{data\PYZus{}test}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{magnitude}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}
             \PY{n}{rmse} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{mean\PYZus{}squared\PYZus{}error}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{)}\PY{p}{)}
             \PY{n}{cv\PYZus{}scores\PYZus{}rmse}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{rmse}\PY{p}{)}
             \PY{n}{mae} \PY{o}{=} \PY{n}{mean\PYZus{}absolute\PYZus{}error}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{)}
             \PY{n}{cv\PYZus{}scores\PYZus{}mae}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{mae}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}28}]:} \PY{n}{cv\PYZus{}scores\PYZus{}rmse}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}28}]:} [1.9805056212006553,
          1.5327856949376133,
          1.3921230956523203,
          1.7292303208405269,
          1.6110181943669848]
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}30}]:} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{cv\PYZus{}scores\PYZus{}rmse}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}30}]:} 1.6491325853996202
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}31}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{cvでの絶対平均誤差}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{cv\PYZus{}scores\PYZus{}mae}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
cvでの絶対平均誤差

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}31}]:} [1.7336468449452318,
          1.2601097476414853,
          1.1367298896505755,
          1.388212753744293,
          1.3970519732105504]
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}32}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{cvscore\PYZus{}maeの平均}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{cv\PYZus{}scores\PYZus{}mae}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
cvscore\_maeの平均

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}32}]:} 1.3831502418384272
\end{Verbatim}
            
    \section{GLMによる推定}\label{glmux306bux3088ux308bux63a8ux5b9a}

    family:gaussian\\
link: identity

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}111}]:} \PY{n}{gaussian\PYZus{}model} \PY{o}{=} \PY{n}{smf}\PY{o}{.}\PY{n}{glm}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{magnitude \PYZti{} phase\PYZus{}diff}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{data} \PY{o}{=} \PY{n}{data}\PY{p}{,} \PY{n}{family}\PY{o}{=}\PY{n}{sm}\PY{o}{.}\PY{n}{families}\PY{o}{.}\PY{n}{Gaussian}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}112}]:} \PY{n}{gaussian\PYZus{}model}\PY{o}{.}\PY{n}{summary}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}112}]:} <class 'statsmodels.iolib.summary.Summary'>
          """
                           Generalized Linear Model Regression Results                  
          ==============================================================================
          Dep. Variable:              magnitude   No. Observations:                  600
          Model:                            GLM   Df Residuals:                      598
          Model Family:                Gaussian   Df Model:                            1
          Link Function:               identity   Scale:              2.5594358281814804
          Method:                          IRLS   Log-Likelihood:                -1132.3
          Date:                Fri, 18 May 2018   Deviance:                       1530.5
          Time:                        14:56:02   Pearson chi2:                 1.53e+03
          No. Iterations:                     2                                         
          ==============================================================================
                           coef    std err          z      P>|z|      [0.025      0.975]
          ------------------------------------------------------------------------------
          Intercept      4.1705      0.121     34.355      0.000       3.933       4.408
          phase\_diff    -0.0063      0.001     -5.515      0.000      -0.008      -0.004
          ==============================================================================
          """
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}113}]:} \PY{n}{gaussian\PYZus{}model}\PY{o}{.}\PY{n}{aic}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}113}]:} 2268.5950118389223
\end{Verbatim}
            
    family:gaussian\\
link: log

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}114}]:} \PY{n}{gaussian\PYZus{}model} \PY{o}{=} \PY{n}{smf}\PY{o}{.}\PY{n}{glm}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{magnitude \PYZti{} phase\PYZus{}diff}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{data} \PY{o}{=} \PY{n}{data}\PY{p}{,} \PY{n}{family}\PY{o}{=}\PY{n}{sm}\PY{o}{.}\PY{n}{families}\PY{o}{.}\PY{n}{Gaussian}\PY{p}{(}\PY{n}{link}\PY{o}{=}\PY{n}{sm}\PY{o}{.}\PY{n}{families}\PY{o}{.}\PY{n}{links}\PY{o}{.}\PY{n}{log}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}115}]:} \PY{n}{gaussian\PYZus{}model}\PY{o}{.}\PY{n}{summary}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}115}]:} <class 'statsmodels.iolib.summary.Summary'>
          """
                           Generalized Linear Model Regression Results                  
          ==============================================================================
          Dep. Variable:              magnitude   No. Observations:                  600
          Model:                            GLM   Df Residuals:                      598
          Model Family:                Gaussian   Df Model:                            1
          Link Function:                    log   Scale:               2.551432913063984
          Method:                          IRLS   Log-Likelihood:                -1131.4
          Date:                Fri, 18 May 2018   Deviance:                       1525.8
          Time:                        14:56:04   Pearson chi2:                 1.53e+03
          No. Iterations:                     7                                         
          ==============================================================================
                           coef    std err          z      P>|z|      [0.025      0.975]
          ------------------------------------------------------------------------------
          Intercept      1.4429      0.031     47.179      0.000       1.383       1.503
          phase\_diff    -0.0018      0.000     -5.819      0.000      -0.002      -0.001
          ==============================================================================
          """
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}116}]:} \PY{n}{gaussian\PYZus{}model}\PY{o}{.}\PY{n}{aic}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}116}]:} 2266.719316669853
\end{Verbatim}
            
    family:gamma\\
link:inverse\_power

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}136}]:} \PY{c+c1}{\PYZsh{}0があると対数尤度が発散してしまうのでごまかし}
          \PY{n}{data}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{magnitude}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{magnitude}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{+} \PY{l+m+mf}{1.0e\PYZhy{}9}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}137}]:} \PY{n}{gamma\PYZus{}model} \PY{o}{=} \PY{n}{smf}\PY{o}{.}\PY{n}{glm}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{magnitude \PYZti{} phase\PYZus{}diff}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{data} \PY{o}{=} \PY{n}{data}\PY{p}{,} \PY{n}{family}\PY{o}{=}\PY{n}{sm}\PY{o}{.}\PY{n}{families}\PY{o}{.}\PY{n}{Gamma}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
C:\textbackslash{}ProgramData\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}statsmodels\textbackslash{}genmod\textbackslash{}generalized\_linear\_model.py:244: DomainWarning: The inverse\_power link function does not respect the domain of the Gamma family.
  DomainWarning)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}138}]:} \PY{n}{gamma\PYZus{}model}\PY{o}{.}\PY{n}{summary}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}138}]:} <class 'statsmodels.iolib.summary.Summary'>
          """
                            Generalized Linear Model Regression Results                  
          ===============================================================================
          Dep. Variable:              magnitude   No. Observations:                   600
          Model:                            GLM   Df Residuals:                       598
          Model Family:                   Gamma   Df Model:                             1
          Link Function:          inverse\_power   Scale:              0.20764731261830163
          Method:                          IRLS   Log-Likelihood:                 -1364.9
          Date:                Fri, 18 May 2018   Deviance:                        266.34
          Time:                        16:17:17   Pearson chi2:                      124.
          No. Iterations:                     5                                          
          ==============================================================================
                           coef    std err          z      P>|z|      [0.025      0.975]
          ------------------------------------------------------------------------------
          Intercept      0.2366      0.009     27.059      0.000       0.219       0.254
          phase\_diff     0.0005   9.01e-05      5.363      0.000       0.000       0.001
          ==============================================================================
          """
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}139}]:} \PY{n}{gamma\PYZus{}model}\PY{o}{.}\PY{n}{aic}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}139}]:} 2733.823085600267
\end{Verbatim}
            
    family:gamma\\
link:log

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}140}]:} \PY{n}{gamma\PYZus{}model} \PY{o}{=} \PY{n}{smf}\PY{o}{.}\PY{n}{glm}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{magnitude \PYZti{} phase\PYZus{}diff}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{data} \PY{o}{=} \PY{n}{data}\PY{p}{,} \PY{n}{family}\PY{o}{=}\PY{n}{sm}\PY{o}{.}\PY{n}{families}\PY{o}{.}\PY{n}{Gamma}\PY{p}{(}\PY{n}{link}\PY{o}{=}\PY{n}{sm}\PY{o}{.}\PY{n}{families}\PY{o}{.}\PY{n}{links}\PY{o}{.}\PY{n}{log}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}141}]:} \PY{n}{gamma\PYZus{}model}\PY{o}{.}\PY{n}{summary}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}141}]:} <class 'statsmodels.iolib.summary.Summary'>
          """
                            Generalized Linear Model Regression Results                  
          ===============================================================================
          Dep. Variable:              magnitude   No. Observations:                   600
          Model:                            GLM   Df Residuals:                       598
          Model Family:                   Gamma   Df Model:                             1
          Link Function:                    log   Scale:              0.20740907975321185
          Method:                          IRLS   Log-Likelihood:                 -1366.0
          Date:                Fri, 18 May 2018   Deviance:                        266.65
          Time:                        16:17:19   Pearson chi2:                      124.
          No. Iterations:                     6                                          
          ==============================================================================
                           coef    std err          z      P>|z|      [0.025      0.975]
          ------------------------------------------------------------------------------
          Intercept      1.4266      0.035     41.281      0.000       1.359       1.494
          phase\_diff    -0.0017      0.000     -5.103      0.000      -0.002      -0.001
          ==============================================================================
          """
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}142}]:} \PY{n}{gamma\PYZus{}model}\PY{o}{.}\PY{n}{aic}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}142}]:} 2736.0408004997507
\end{Verbatim}
            
    \section{個人ごとで推定させる}\label{ux500bux4ebaux3054ux3068ux3067ux63a8ux5b9aux3055ux305bux308b}


    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
